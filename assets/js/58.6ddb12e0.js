(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{498:function(s,t,n){"use strict";n.r(t);var e=n(10),a=Object(e.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"jenkins、mysql、gogs、nginx的安装和整合"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jenkins、mysql、gogs、nginx的安装和整合"}},[s._v("#")]),s._v(" jenkins、mysql、gogs、nginx的安装和整合")]),s._v(" "),n("h2",{attrs:{id:"jenkins安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jenkins安装"}},[s._v("#")]),s._v(" jenkins安装")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run  --name jenkins  -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8002")]),s._v(":8080 --mount "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source=jenkins,target=/var/jenkins_home"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /etc/timezone:/etc/timezone:ro "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /etc/localtime:/etc/localtime:ro "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /var/run/docker.sock:/var/run/docker.sock -v /usr/bin/docker:/usr/bin/docker jenkins/jenkins\n")])])]),n("p",[n("em",[s._v("一定要用jenkins/jenkins这个库，不要使用docker官方的jenkins库")])]),s._v(" "),n("p",[n("strong",[s._v("使用国内的插件源")])]),s._v(" "),n("ol",[n("li",[s._v("由于上面挂载了jenkins_home到宿主机，所以直接在宿主机中操作文件即可")]),s._v(" "),n("li",[n("code",[s._v("nano /var/lib/docker/volumns/jenkins/_data/hudson.model.UpdateCenter.xml")])]),s._v(" "),n("li",[s._v("修改URL为清华源或其他的")])]),s._v(" "),n("ul",[n("li",[s._v("https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json")]),s._v(" "),n("li",[s._v("http://mirror.esuni.jp/jenkins/updates/update-center.json")])]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[s._v("上述步骤的2，3错误，从清华源等下载下来的json中，插件仍是指向jenkins-ci.org的下载源。")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/hellxz/p/jenkins_install_plugins_faster.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("容器中："),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/jenkins_home/updates/\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed 替换链接")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/http:\\/\\/updates.jenkins-ci.org\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g'")]),s._v(" default.json "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g'")]),s._v(" default.json\n")])])])]),s._v(" "),n("li",[s._v("如果在jenkins中使用docker命令，需要执行"),n("code",[s._v("cd /var/run/ && chmod 777 docker.sock")])]),s._v(" "),n("li",[s._v("体验秒安装的快感")]),s._v(" "),n("li",[s._v("插件选择gogs,maven,simple chinese location.")])]),s._v(" "),n("h2",{attrs:{id:"mysql的安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql的安装"}},[s._v("#")]),s._v(" MySQL的安装")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run --name some-mysql -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password --mount "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source=mysql_data,target=/var/lib/mysql"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /etc/localtime:/etc/localtime:ro -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 -d mysql:8.0.18\n")])])]),n("p",[n("em",[s._v("注意要修改上诉脚本中的root初始密码")])]),s._v(" "),n("p",[n("strong",[s._v("mysql会存在查询慢的问题，去掉dns检索")]),n("br"),s._v(" "),n("code",[s._v("/etc/mysql/conf.d/mysql.cnf")]),s._v("的[mysqld]后面加上")]),s._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("skip-name-resolve\ninnodb_flush_log_at_trx_commit=0\nsync_binlog=0\n")])])]),n("h2",{attrs:{id:"gogs的安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gogs的安装"}},[s._v("#")]),s._v(" gogs的安装")])])}),[],!1,null,null,null);t.default=a.exports}}]);