(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{447:function(t,a,s){"use strict";s.r(a);var n=s(10),e=function(t){t.options.__data__block__={mermaid_64a56f6c:"graph LR\næºä»£ç --\x3e1.ç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’åº--\x3e2.æŒ‡ä»¤å¹¶è¡Œçš„é‡æ’åº--\x3e3.å†…å­˜ç³»ç»Ÿé‡æ’åº--\x3eæœ€ç»ˆæ‰§è¡Œçš„æŒ‡ä»¤\n",mermaid_64a568ea:"classDiagram\nAbstractQueuedSynchronizer <|--Sync\nSync<|--FailSync\nSync<|--NonfailSync\nNonfailSync o-- ReentrantLock\nFailSync o-- ReentrantLock\n\nclass AbstractQueuedSynchronizer{\n\t-volatile state\n\t+acquire() void\n\t+release() boolean\n}\n\nclass Sync{\n\t+nonfairTryAcquire(int acquires) void\n\t+tryRelease(int release) void\n}\nclass FailSync{\n\t+lock() void\n\t+tryAcquire(int acquires) void\n}\n\nclass NonfailSync{\n\t+lock() void\n\t+tryAcquire(int acquires) void\n}\nclass ReentrantLock{\n\t-Sync sync\n\t+lock() void\n\t+unlock() void\n}\n\n",mermaid_64a54a24:"graph TD\nå¤§ä»»åŠ¡ ---|Fork| å­ä»»åŠ¡1\nå¤§ä»»åŠ¡ ---|Fork| å­ä»»åŠ¡2\nå¤§ä»»åŠ¡ ---|Fork| å­ä»»åŠ¡3\nå­ä»»åŠ¡1 ---|Fork| å­ä»»åŠ¡1.1\nå­ä»»åŠ¡1 ---|Fork| å­ä»»åŠ¡1.2\nå­ä»»åŠ¡1.1 ---|Join| ä»»åŠ¡1ç»“æœ\nå­ä»»åŠ¡1.2 ---|Join| ä»»åŠ¡1ç»“æœ\nå­ä»»åŠ¡2 --- ä»»åŠ¡2ç»“æœ\nå­ä»»åŠ¡3 ---|Fork| å­ä»»åŠ¡3.1\nå­ä»»åŠ¡3 ---|Fork| å­ä»»åŠ¡3.2\nå­ä»»åŠ¡3.1 ---|Join| ä»»åŠ¡3ç»“æœ\nå­ä»»åŠ¡3.2 ---|Join| ä»»åŠ¡3ç»“æœ\nä»»åŠ¡1ç»“æœ ---|Join| å¤§ä»»åŠ¡ç»“æœ\nä»»åŠ¡2ç»“æœ ---|Join| å¤§ä»»åŠ¡ç»“æœ\nä»»åŠ¡3ç»“æœ ---|Join| å¤§ä»»åŠ¡ç»“æœ\n",mermaid_64a53bd2:"graph LR\nA[æäº¤ä»»åŠ¡]--\x3eB{æ ¸å¿ƒçº¿ç¨‹å·²æ»¡}--Yes--\x3eC{é˜Ÿåˆ—æ˜¯å¦å·²æ»¡}--Yes--\x3eD{çº¿ç¨‹æ± æ˜¯å¦å·²æ»¡}\nD--Yes--\x3eEND[æŒ‰ç…§é¥±å’Œç­–ç•¥å¤„ç†]\nB--No--\x3eE[åˆ›å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡]\nC--No--\x3eF[å­˜å…¥é˜Ÿåˆ—]\nD--No--\x3eG[åˆ›å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡]\n"}},r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"javaå¤šçº¿ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaå¤šçº¿ç¨‹"}},[t._v("#")]),t._v(" Javaå¤šçº¿ç¨‹")]),t._v(" "),s("p",[t._v("æœ¬æ–‡åŸºäºã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹")]),t._v(" "),s("h2",{attrs:{id:"å¹¶å‘ç¼–ç¨‹çš„æŒ‘æˆ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¹¶å‘ç¼–ç¨‹çš„æŒ‘æˆ˜"}},[t._v("#")]),t._v(" å¹¶å‘ç¼–ç¨‹çš„æŒ‘æˆ˜")]),t._v(" "),s("h2",{attrs:{id:"javaå¹¶å‘æœºåˆ¶çš„åº•å±‚å®ç°åŸç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaå¹¶å‘æœºåˆ¶çš„åº•å±‚å®ç°åŸç†"}},[t._v("#")]),t._v(" Javaå¹¶å‘æœºåˆ¶çš„åº•å±‚å®ç°åŸç†")]),t._v(" "),s("h3",{attrs:{id:"volatileçš„åº”ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#volatileçš„åº”ç”¨"}},[t._v("#")]),t._v(" "),s("code",[t._v("volatile")]),t._v("çš„åº”ç”¨")]),t._v(" "),s("h4",{attrs:{id:"å®šä¹‰å’Œå®ç°åŸç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰å’Œå®ç°åŸç†"}},[t._v("#")]),t._v(" å®šä¹‰å’Œå®ç°åŸç†")]),t._v(" "),s("p",[s("code",[t._v("volatile")]),t._v("æ˜¯å¦‚ä½•æ¥ä¿è¯å¯è§æ€§çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬åœ¨X86å¤„ç†å™¨ä¸‹é€šè¿‡å·¥å…·è·å–JITç¼–è¯‘å™¨ç”Ÿæˆçš„æ±‡ç¼–æŒ‡ä»¤æ¥æŸ¥çœ‹å¯¹"),s("code",[t._v("volatile")]),t._v("è¿›è¡Œå†™æ“ä½œæ—¶CPUä¼šåšä»€ä¹ˆäº‹æƒ…ã€‚")]),t._v(" "),s("p",[s("code",[t._v("Java")]),t._v("ä»£ç å¦‚ä¸‹ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("instance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  instance æ˜¯ volatile å˜é‡")]),t._v("\n")])])]),s("p",[t._v("è½¬å˜æˆæ±‡ç¼–ä»£ç ï¼Œå¦‚ä¸‹ã€‚")]),t._v(" "),s("div",{staticClass:"language-assembly extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("0x01a3de1d: movb $0Ã—0,0Ã—1104800(%esi);0x01a3de24: lock addl $0Ã—0,(%esp);\n")])])]),s("h4",{attrs:{id:"lockå‰ç¼€çš„æŒ‡ä»¤åœ¨å¤šæ ¸å¤„ç†å™¨ä¸‹ä¼šå¼•å‘äº†ä¸¤ä»¶äº‹æƒ…"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lockå‰ç¼€çš„æŒ‡ä»¤åœ¨å¤šæ ¸å¤„ç†å™¨ä¸‹ä¼šå¼•å‘äº†ä¸¤ä»¶äº‹æƒ…"}},[t._v("#")]),t._v(" "),s("code",[t._v("Lock")]),t._v("å‰ç¼€çš„æŒ‡ä»¤åœ¨å¤šæ ¸å¤„ç†å™¨ä¸‹ä¼šå¼•å‘äº†ä¸¤ä»¶äº‹æƒ…")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("Lock")]),t._v("å‰ç¼€æŒ‡ä»¤ä¼šå¼•èµ·å¤„ç†å™¨ç¼“å­˜å›å†™åˆ°å†…å­˜")]),t._v("\nè¿™ä¸ªæ¶‰åŠåˆ°å¤„ç†å™¨çš„ç¡¬ä»¶å®ç°ã€‚å’Œä»£ç æ— å…³ã€‚æœ‰çš„æ˜¯é”æ€»çº¿ï¼Œé”æ€»çº¿å½“å‰çº¿ç¨‹ä¼šç‹¬å å…±äº«å†…å­˜ï¼›æœ‰çš„æ˜¯é”ç¼“å­˜ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("ä¸€ä¸ªå¤„ç†å™¨çš„ç¼“å­˜å›å†™åˆ°å†…å­˜ä¼šå¯¼è‡´å…¶ä»–å¤„ç†å™¨çš„ç¼“å­˜æ— æ•ˆ")])]),t._v(" "),s("p",[s("code",[t._v("IA-32")]),t._v("å¤„ç†å™¨å’Œ"),s("code",[t._v("Intel 64")]),t._v("å¤„ç†å™¨ä½¿ç”¨ MESIï¼ˆä¿®æ”¹ã€ç‹¬å ã€å…±äº«ã€æ— æ•ˆï¼‰æ§åˆ¶åè®®å»ç»´æŠ¤å†…éƒ¨ç¼“å­˜å’Œå…¶ä»–å¤„ç†å™¨ç¼“å­˜çš„ä¸€è‡´æ€§ã€‚")]),t._v(" "),s("h3",{attrs:{id:"synchronizedçš„å®ç°åŸç†å’Œä¼˜åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#synchronizedçš„å®ç°åŸç†å’Œä¼˜åŒ–"}},[t._v("#")]),t._v(" "),s("code",[t._v("synchronized")]),t._v("çš„å®ç°åŸç†å’Œä¼˜åŒ–")]),t._v(" "),s("p",[s("code",[t._v("java")]),t._v("ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ï¼Œä¸»è¦æœ‰è¿™ä¸‰ç§")]),t._v(" "),s("ul",[s("li",[t._v("å¯¹äºæ™®é€šæ–¹æ³•ï¼Œé”æ˜¯å½“å‰å®ä¾‹å¯¹è±¡ã€‚")]),t._v(" "),s("li",[t._v("å¯¹äºé™æ€åŒæ­¥æ–¹æ³•ï¼Œé”æ˜¯å½“å‰ç±»çš„Classå¯¹è±¡")]),t._v(" "),s("li",[t._v("å¯¹äºåŒæ­¥å—æ–¹æ³•ï¼Œé”æ˜¯"),s("code",[t._v("synchronized")]),t._v("æ‹¬å·é‡Œçš„å¯¹è±¡")])]),t._v(" "),s("h4",{attrs:{id:"å°†ç¼“å­˜æ•°æ®åˆ·å›ä¸»å­˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å°†ç¼“å­˜æ•°æ®åˆ·å›ä¸»å­˜"}},[t._v("#")]),t._v(" å°†ç¼“å­˜æ•°æ®åˆ·å›ä¸»å­˜")]),t._v(" "),s("p",[s("strong",[t._v("ç¦»å¼€ä¸€ä¸ª"),s("code",[t._v("synchronized")]),t._v("å—ä¼šå¯¼è‡´å½“å‰çº¿ç¨‹æ‰€æœ‰å†™å…¥åˆ°ç¼“å­˜çš„æ•°æ®åˆ·æ–°ï¼Œè¿›å…¥ä¸€ä¸ª"),s("code",[t._v("synchronized")]),t._v("å—ä¼šå¯¼è‡´æ‰€æœ‰å¯å˜æ•°æ®é‡æ–°ä»ä¸»å­˜è·å–ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"é”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é”"}},[t._v("#")]),t._v(" é”")]),t._v(" "),s("p",[t._v("çº§åˆ«ä»ä½åˆ°é«˜ï¼šæ— é”ï¼Œåå‘é”ï¼Œè½»é‡é”ï¼Œé‡é‡é”ã€‚é”çš„çŠ¶æ€ä¼šéšç€ç«äº‰æƒ…å†µé€æ¸å‡çº§ã€‚ä½†ä¸èƒ½é™çº§ã€‚")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("é”")]),t._v(" "),s("th",[t._v("ä¼˜ç‚¹")]),t._v(" "),s("th",[t._v("ç¼ºç‚¹")]),t._v(" "),s("th",[t._v("ä½¿ç”¨åœºæ™¯")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("åå‘é”")]),t._v(" "),s("td",[t._v("åŠ é”å’Œè§£é”ä¸éœ€è¦é¢å¤–çš„æ¶ˆè€—ï¼Œå’Œæ‰§è¡ŒéåŒæ­¥æ–¹æ³•ç›¸æ¯”ä»…å­˜åœ¨çº³ç§’çº§åˆ«çš„å·®è·")]),t._v(" "),s("td",[t._v("å¦‚æœçº¿ç¨‹é—´å­˜åœ¨é”ç«äº‰ï¼Œä¼šå¸¦æ¥é¢å¤–çš„é”æ’¤é”€çš„æ¶ˆè€—")]),t._v(" "),s("td",[t._v("é€‚ç”¨äºåªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥è¯­å—")])]),t._v(" "),s("tr",[s("td",[t._v("è½»é‡çº§é”")]),t._v(" "),s("td",[t._v("ç«äº‰çš„çº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯è‡ªæ—‹ç­‰å¾…ã€‚æé«˜äº†ç¨‹åºçš„å“åº”é€Ÿåº¦")]),t._v(" "),s("td",[t._v("å¦‚æœå§‹ç»ˆå¾—ä¸åˆ°é”ç«äº‰çš„çº¿ç¨‹ï¼Œä½¿ç”¨è‡ªæ—‹ä¼šæ¶ˆè€—CPU")]),t._v(" "),s("td",[t._v("è¿½æ±‚å“åº”æ—¶é—´ï¼ŒåŒæ­¥è¯­å—æ‰§è¡Œé€Ÿåº¦éå¸¸å¿«")])]),t._v(" "),s("tr",[s("td",[t._v("é‡é‡çº§é”")]),t._v(" "),s("td",[t._v("çº¿ç¨‹ç«äº‰ä¸ä½¿ç”¨çº¿ç¨‹ï¼Œä¸ä¼šæ¶ˆè€—CPU")]),t._v(" "),s("td",[t._v("çº¿ç¨‹é˜»å¡ï¼Œå“åº”æ—¶é—´ç¼“æ…¢")]),t._v(" "),s("td",[t._v("è¿½æ±‚ååé‡ï¼ŒåŒæ­¥è¯­å—æ‰§è¡Œé€Ÿåº¦æ…¢")])])])]),t._v(" "),s("h2",{attrs:{id:"javaå†…å­˜æ¨¡å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaå†…å­˜æ¨¡å‹"}},[t._v("#")]),t._v(" "),s("code",[t._v("Java")]),t._v("å†…å­˜æ¨¡å‹")]),t._v(" "),s("h3",{attrs:{id:"å¤šçº¿ç¨‹é€šä¿¡-jmm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¤šçº¿ç¨‹é€šä¿¡-jmm"}},[t._v("#")]),t._v(" å¤šçº¿ç¨‹é€šä¿¡ JMM")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.clinan.xyz/jmm.png",alt:"jmm"}})]),t._v(" "),s("h3",{attrs:{id:"æŒ‡ä»¤é‡æ’åº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æŒ‡ä»¤é‡æ’åº"}},[t._v("#")]),t._v(" æŒ‡ä»¤é‡æ’åº")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("ç¼–è¯‘å™¨ä¼˜åŒ–çš„é‡æ’åºï¼Œç¼–è¯‘å™¨åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºæ‰§è¡Œè¯­ä¹‰çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é‡æ–°å®‰æ’è¯­å¥çš„æ‰§è¡Œé¡ºåºã€‚")])]),t._v(" "),s("li",[s("p",[t._v("æŒ‡ä»¤å¹¶è¡Œçš„é‡æ’åºã€‚æŒ‡ä»¤çº§å¹¶è¡Œçš„é‡æ’åºã€‚ç°ä»£å¤„ç†å™¨é‡‡ç”¨äº†æŒ‡ä»¤çº§å¹¶è¡ŒæŠ€æœ¯ï¼ˆ "),s("code",[t._v("Instruction-LevelParallelism, ILP")]),t._v("ï¼‰æ¥å°†å¤šæ¡æŒ‡ä»¤é‡å æ‰§è¡Œã€‚å¦‚æœä¸å­˜åœ¨æ•°æ®ä¾èµ–æ€§ï¼Œå¤„ç†å™¨å¯ä»¥æ”¹å˜è¯­å¥å¯¹åº”æœºå™¨æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚")])]),t._v(" "),s("li",[s("p",[t._v("å†…å­˜ç³»ç»Ÿçš„é‡æ’åºã€‚ç”±äºå¤„ç†å™¨ä½¿ç”¨ç¼“å­˜å’Œè¯»å†™ç¼“å†²åŒºï¼Œè¿™ä½¿å¾—åŠ è½½å’Œå­˜å‚¨æ“ä½œçœ‹ä¸Šå»å¯èƒ½æ˜¯åœ¨ä¹±åºæ‰§è¡Œã€‚")]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a56f6c",graph:t.$dataBlock.mermaid_64a56f6c}}),s("p",[t._v("ä¸Šè¿°çš„1å±äºç¼–è¯‘å™¨é‡æ’åºï¼Œ2å’Œ 3å±äºå¤„ç†å™¨é‡æ’åºã€‚è¿™äº›é‡æ’åºå¯èƒ½ä¼šå¯¼è‡´å¤šçº¿ç¨‹ç¨‹åºå‡ºç°å†…å­˜å¯è§æ€§é—®é¢˜ã€‚å¯¹äºç¼–è¯‘å™¨ï¼ŒJMMçš„ç¼–è¯‘å™¨é‡æ’åºè§„åˆ™ä¼šç¦æ­¢ç‰¹å®šç±»å‹çš„ç¼–è¯‘å™¨é‡æ’åºï¼ˆä¸æ˜¯æ‰€æœ‰çš„ç¼–è¯‘å™¨é‡æ’åºéƒ½è¦ç¦æ­¢ï¼‰ã€‚å¯¹äºå¤„ç†å™¨é‡æ’åºï¼ŒJMMçš„å¤„ç†å™¨é‡æ’åºè§„åˆ™ä¼šè¦æ±‚ Javaç¼–è¯‘å™¨åœ¨ç”ŸæˆæŒ‡ä»¤åºåˆ—æ—¶ï¼Œæ’å…¥ç‰¹å®šç±»å‹çš„å†…å­˜å±éšœ"),s("code",[t._v("Memory Barriers")]),t._v("ï¼Œ Intelç§°ä¹‹ä¸º "),s("code",[t._v("Memory Fence")]),t._v("ï¼‰æŒ‡ä»¤ï¼Œé€šè¿‡å†…å­˜å±éšœæŒ‡ä»¤æ¥ç¦æ­¢ç‰¹å®šç±»å‹çš„å¤„ç†å™¨é‡æ’åºã€‚")])],1)]),t._v(" "),s("p",[s("strong",[t._v("JMMå±äºè¯­è¨€çº§çš„å†…å­˜æ¨¡å‹")]),t._v("ï¼Œå®ƒç¡®ä¿åœ¨ä¸åŒçš„ç¼–è¯‘å™¨å’Œä¸åŒçš„å¤„ç†å™¨å¹³å°ä¹‹ä¸Šï¼Œé€šè¿‡ç¦æ­¢ç‰¹å®šç±»å‹çš„ç¼–è¯‘å™¨é‡æ’åºå’Œå¤„ç†å™¨é‡æ’åºï¼Œä¸º ç¨‹åºå‘˜æä¾›ä¸€è‡´çš„å†…å­˜å¯è§æ€§ä¿è¯ ã€‚")]),t._v(" "),s("h3",{attrs:{id:"volatileçš„å†…å­˜è¯­ä¹‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#volatileçš„å†…å­˜è¯­ä¹‰"}},[t._v("#")]),t._v(" "),s("code",[t._v("volatile")]),t._v("çš„å†…å­˜è¯­ä¹‰")]),t._v(" "),s("p",[s("code",[t._v("volatile")]),t._v("å˜é‡è‡ªèº«å…·æœ‰ä¸‹åˆ—ç‰¹æ€§")]),t._v(" "),s("ul",[s("li",[t._v("å¯è§æ€§ï¼Œå¯¹ä¸€ä¸ª"),s("code",[t._v("volatile")]),t._v("å˜é‡çš„è¯»ï¼Œæ€»æ˜¯èƒ½çœ‹åˆ°ï¼ˆä»»æ„çº¿ç¨‹ï¼‰å¯¹è¿™ä¸ª"),s("code",[t._v("volatile")]),t._v("å˜é‡æœ€åçš„å†™å…¥ã€‚")]),t._v(" "),s("li",[s("s",[t._v("åŸå­æ€§")]),t._v(" ï¼Œå¯¹ä»»æ„å•ä¸ª"),s("code",[t._v("volatile")]),t._v("å˜é‡çš„è¯»/å†™å…·æœ‰åŸå­æ€§ï¼Œä½†ç±»ä¼¼äº"),s("code",[t._v("volatile++")]),t._v("è¿™ç§å¤åˆæ“ä½œä¸å…·æœ‰åŸå­æ€§ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"volatileé‡æ’åºè§„åˆ™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#volatileé‡æ’åºè§„åˆ™"}},[t._v("#")]),t._v(" "),s("code",[t._v("volatile")]),t._v("é‡æ’åºè§„åˆ™")]),t._v(" "),s("ul",[s("li",[t._v("å½“"),s("strong",[t._v("ç¬¬äºŒä¸ª")]),t._v("æ“ä½œæ˜¯"),s("code",[t._v("volatile")]),t._v("å†™çš„æ—¶å€™ï¼Œä¸ç®¡ç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºã€‚è¿™ä¸ªè§„åˆ™ç¡®ä¿"),s("code",[t._v("volatile")]),t._v("å†™ä¹‹å‰çš„æ“ä½œä¸ä¼šè¢«ç¼–è¯‘å™¨é‡æ’åºåˆ°"),s("code",[t._v("volatile")]),t._v("å†™ä¹‹åã€‚")]),t._v(" "),s("li",[t._v("å½“"),s("strong",[t._v("ç¬¬ä¸€ä¸ª")]),t._v("æ“ä½œæ˜¯"),s("code",[t._v("volatile")]),t._v("è¯»æ—¶ï¼Œä¸ç®¡ç¬¬äºŒä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºã€‚è¿™ä¸ªè§„åˆ™ç¡®ä¿"),s("code",[t._v("volatile")]),t._v("è¯»ä¹‹åçš„æ“ä½œä¸ä¼šè¢«ç¼–è¯‘å™¨é‡æ’åºåˆ°"),s("code",[t._v("volatile")]),t._v("è¯»ä¹‹å‰ã€‚")]),t._v(" "),s("li",[t._v("ç¬¬ä¸€ä¸ªæ“ä½œæ˜¯"),s("code",[t._v("volatile")]),t._v("å†™ï¼Œç¬¬äºŒä¸ªæ“ä½œæ—¶"),s("code",[t._v("volatile")]),t._v("è¯»æ—¶ï¼Œä¸èƒ½é‡æ’åºã€‚")])]),t._v(" "),s("p",[t._v("ä¸ºäº†å®ç°"),s("code",[t._v("volatile")]),t._v("çš„å†…å­˜è¯­ä¹‰ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œä¼šåœ¨")]),t._v(" "),s("h3",{attrs:{id:"é”çš„å†…å­˜è¯­ä¹‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é”çš„å†…å­˜è¯­ä¹‰"}},[t._v("#")]),t._v(" é”çš„å†…å­˜è¯­ä¹‰")]),t._v(" "),s("p",[t._v("ä»¥"),s("code",[t._v("JUC")]),t._v("åŒ…çš„"),s("code",[t._v("ReentrantLock")]),t._v("ä½œä¸ºä¾‹å­ã€‚")]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a568ea",graph:t.$dataBlock.mermaid_64a568ea}}),s("h5",{attrs:{id:"å¯¹å…¬å¹³é”å’Œç»™å…¬å¹³é”çš„å†…å­˜è¯­ä¹‰çš„æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹å…¬å¹³é”å’Œç»™å…¬å¹³é”çš„å†…å­˜è¯­ä¹‰çš„æ€»ç»“"}},[t._v("#")]),t._v(" å¯¹å…¬å¹³é”å’Œç»™å…¬å¹³é”çš„å†…å­˜è¯­ä¹‰çš„æ€»ç»“")]),t._v(" "),s("ul",[s("li",[t._v("å…¬å¹³é”å’Œéå…¬å¹³é”è¿›è¡Œé‡Šæ”¾æ—¶ï¼Œæœ€åéƒ½è¦å†™ä¸€ä¸ª"),s("code",[t._v("volatile")]),t._v("çš„å˜é‡"),s("code",[t._v("state")])]),t._v(" "),s("li",[t._v("å…¬å¹³é”è·å–æ—¶ï¼Œé¦–å…ˆä¼šå»è¯»"),s("code",[t._v("volatile")]),t._v("å˜é‡"),s("code",[t._v("state")])]),t._v(" "),s("li",[t._v("éå…¬å¹³é”è·å–æ—¶ï¼Œé¦–å…ˆä¼šç”¨"),s("code",[t._v("CAS")]),t._v("æ›´æ–°"),s("code",[t._v("volatile")]),t._v("å˜é‡ï¼Œè¿™ä¸ªæ“ä½œåŒæ—¶å…·æœ‰"),s("code",[t._v("volatile")]),t._v("è¯»å’Œ"),s("code",[t._v("volatile")]),t._v("å†™çš„å†…å­˜è¯­ä¹‰")])]),t._v(" "),s("p",[t._v("é”é‡Šæ”¾å’Œé”è·å–è‡³å°‘æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼")]),t._v(" "),s("ul",[s("li",[t._v("åˆ©ç”¨"),s("code",[t._v("volatile")]),t._v("å˜é‡çš„è¯»-å†™é”å…·æœ‰çš„å†…å­˜è¯­ä¹‰")]),t._v(" "),s("li",[t._v("åˆ©ç”¨"),s("code",[t._v("CAS")]),t._v("æ‰€é™„å¸¦çš„"),s("code",[t._v("volatile")]),t._v("è¯»å’Œ"),s("code",[t._v("volatile")]),t._v("å†™çš„å†…å­˜è¯­ä¹‰")])]),t._v(" "),s("h3",{attrs:{id:"finalçš„å†…å­˜è¯­ä¹‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#finalçš„å†…å­˜è¯­ä¹‰"}},[t._v("#")]),t._v(" "),s("code",[t._v("final")]),t._v("çš„å†…å­˜è¯­ä¹‰")]),t._v(" "),s("p",[t._v("ä¸¤ä¸ªé‡æ’åºè§„åˆ™")]),t._v(" "),s("ul",[s("li",[t._v("åœ¨æ„é€ å‡½æ•°å†…å¯¹ä¸€ä¸ª"),s("code",[t._v("final")]),t._v("åŸŸçš„å†™å…¥ï¼Œä¸éšåæŠŠè¿™ä¸ªæ„é€ å¯¹è±¡çš„å¼•ç”¨èµ‹å€¼ç»™ä¸€ä¸ªå¼•ç”¨å˜é‡ï¼Œè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´ä¸èƒ½é‡æ’åºã€‚")]),t._v(" "),s("li",[t._v("åˆæ¬¡è¯»ä¸€ä¸ªåŒ…å«"),s("code",[t._v("final")]),t._v("åŸŸçš„å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸éšååˆæ¬¡è¯»è¿™ä¸ª"),s("code",[t._v("final")]),t._v("åŸŸï¼Œè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´ä¸èƒ½é‡æ’åºã€‚")])]),t._v(" "),s("p",[t._v("è¯»"),s("code",[t._v("final")]),t._v("åŸŸçš„é‡æ’åºè§„åˆ™æ˜¯ï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œåˆæ¬¡è¯»å¯¹è±¡å¼•ç”¨ä¸åˆæ¬¡è¯»è¯¥å¯¹è±¡åŒ…å«çš„"),s("code",[t._v("final")]),t._v("åŸŸï¼ŒJMMç¦æ­¢å¤„ç†å™¨é‡æ’åºè¿™ä¸¤ä¸ªæ“ä½œï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªè§„åˆ™ä»…ä»…é’ˆå¯¹å¤„ç†å™¨ï¼‰ã€‚ç¼–è¯‘å™¨ä¼šåœ¨è¯»"),s("code",[t._v("final")]),t._v("åŸŸæ“ä½œçš„å‰é¢æ’å…¥ä¸€ä¸ª"),s("code",[t._v("LoadLoad")]),t._v("å±éšœã€‚")]),t._v(" "),s("h3",{attrs:{id:"happens-before"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#happens-before"}},[t._v("#")]),t._v(" happens-before")]),t._v(" "),s("p",[t._v("åœ¨JMMä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ‰§è¡Œçš„ç»“æœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»è¦å­˜åœ¨"),s("code",[t._v("happens-befor")]),t._v("eå…³ç³»ã€‚è¿™é‡Œæåˆ°çš„ä¸¤ä¸ªæ“ä½œæ—¢å¯ä»¥æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´ã€‚")]),t._v(" "),s("p",[t._v("*ã€ŠJSR-133:JavaMemoryModelandThreadSpecificationã€‹*å®šä¹‰äº†å¦‚ä¸‹"),s("code",[t._v("happens-before")]),t._v("è§„åˆ™ã€‚")]),t._v(" "),s("ol",[s("li",[t._v("ç¨‹åºé¡ºåºè§„åˆ™ï¼šä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸ªæ“ä½œï¼Œ"),s("code",[t._v("happens-before")]),t._v("äºè¯¥çº¿ç¨‹ä¸­çš„ä»»æ„åç»­æ“ä½œã€‚")]),t._v(" "),s("li",[t._v("ç›‘è§†å™¨é”è§„åˆ™ï¼šå¯¹ä¸€ä¸ªé”çš„è§£é”ï¼Œ"),s("code",[t._v("happens-before")]),t._v("äºéšåå¯¹è¿™ä¸ªé”çš„åŠ é”ã€‚")]),t._v(" "),s("li",[s("code",[t._v("volatile")]),t._v("å˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ª"),s("code",[t._v("volatile")]),t._v("åŸŸçš„å†™ï¼Œ"),s("code",[t._v("happens-before")]),t._v("äºä»»æ„åç»­å¯¹è¿™ä¸ª"),s("code",[t._v("volatile")]),t._v("åŸŸçš„è¯»ã€‚")]),t._v(" "),s("li",[t._v("ä¼ é€’æ€§ï¼šå¦‚æœ"),s("code",[t._v("A happens-before B")]),t._v("ï¼Œä¸”"),s("code",[t._v("B happens-before C")]),t._v("ï¼Œé‚£ä¹ˆ"),s("code",[t._v("A happens-before C")]),t._v("ã€‚")]),t._v(" "),s("li",[s("code",[t._v("start()")]),t._v("è§„åˆ™ï¼šå¦‚æœçº¿ç¨‹Aæ‰§è¡Œæ“ä½œ"),s("code",[t._v("ThreadB.start()")]),t._v("ï¼ˆå¯åŠ¨çº¿ç¨‹Bï¼‰ï¼Œé‚£ä¹ˆAçº¿ç¨‹çš„"),s("code",[t._v("ThreadB.start()")]),t._v("æ“ä½œ"),s("code",[t._v("happens-before")]),t._v("äºçº¿ç¨‹Bä¸­çš„ä»»æ„æ“ä½œã€‚")]),t._v(" "),s("li",[s("code",[t._v("join()")]),t._v("è§„åˆ™ï¼šå¦‚æœçº¿ç¨‹Aæ‰§è¡Œæ“ä½œ"),s("code",[t._v("ThreadB.join()")]),t._v("å¹¶æˆåŠŸè¿”å›ï¼Œé‚£ä¹ˆçº¿ç¨‹Bä¸­çš„ä»»æ„æ“ä½œ"),s("code",[t._v("happens-before")]),t._v("äºçº¿ç¨‹Aä»"),s("code",[t._v("ThreadB.join()")]),t._v("æ“ä½œæˆåŠŸè¿”å›ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"åŒé‡æ£€æŸ¥é”å®š-double-checked-locking"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŒé‡æ£€æŸ¥é”å®š-double-checked-locking"}},[t._v("#")]),t._v(" åŒé‡æ£€æŸ¥é”å®šï¼Œdouble-checked locking")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// volatile å…³é”®å­—ä¿è¯ï¼Œå½“uniqueInstanceè¢«å®ä¾‹æ—¶ï¼Œå¤šä¸ªçº¿ç¨‹èƒ½æ­£ç¡®çš„è·å–uniqueInstanceå˜é‡")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),t._v(" uniqueInstance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ£€æŸ¥å®ä¾‹ï¼Œå¦‚æœä¸å­˜åœ¨å°±è¿›å…¥åŒæ­¥å—")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uniqueInstance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨æ„ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡æ‰å½»åº•æ‰§è¡Œè¿™é‡Œçš„ä»£ç ")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿›å…¥åŒæ­¥å—åï¼Œå†æ¬¡æ£€æŸ¥ï¼Œå¦‚æœè¿˜æ˜¯nullæ‰åˆ›å»ºã€‚")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uniqueInstance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    uniqueInstance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Singleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" uniqueInstance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"å»¶è¿Ÿåˆå§‹åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿåˆå§‹åŒ–"}},[t._v("#")]),t._v(" å»¶è¿Ÿåˆå§‹åŒ–")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InstanceFactory")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InstanceHolder")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Instance")]),t._v(" instance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Instance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Instance")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œå°†å¯¼è‡´ InstanceHolder ç±»è¢«åŠ è½½å¹¶åˆå§‹åŒ–")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InstanceHolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"javaå¹¶å‘ç¼–ç¨‹åŸºç¡€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaå¹¶å‘ç¼–ç¨‹åŸºç¡€"}},[t._v("#")]),t._v(" Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€")]),t._v(" "),s("p",[t._v("Javaçº¿ç¨‹çŠ¶æ€")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("çŠ¶æ€åç§°")]),t._v(" "),s("th",[t._v("è¯´æ˜")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("new")])]),t._v(" "),s("td",[t._v("åˆ›å»ºå®Œæˆï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œ"),s("code",[t._v("start()")]),t._v("æ–¹æ³•")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("runnable")])]),t._v(" "),s("td",[t._v("è¿è¡Œä¸­")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("blocked")])]),t._v(" "),s("td",[t._v("å µå¡ï¼Œæ ‡è¯†çº¿ç¨‹è¢«é”å µå¡ç€")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("waiting")])]),t._v(" "),s("td",[t._v("ç­‰å¾…å…¶ä»–çº¿ç¨‹åšå‡ºä¸€äº›ç‰¹å®šæ“ä½œï¼Œå¦‚é€šçŸ¥æˆ–ä¸­æ–­")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("time_waiting")])]),t._v(" "),s("td",[t._v("è¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼Œå®ƒæ˜¯å¯ä»¥åœ¨æŒ‡å®šæ—¶é—´è‡ªè¡Œè¿”å›çš„")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("terminated")])]),t._v(" "),s("td",[t._v("ç»ˆæ­¢çŠ¶æ€ï¼Œçº¿ç¨‹æ‰§è¡Œå®Œæ¯•")])])])]),t._v(" "),s("h2",{attrs:{id:"javaä¸­çš„é”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaä¸­çš„é”"}},[t._v("#")]),t._v(" Javaä¸­çš„é”")]),t._v(" "),s("h3",{attrs:{id:"lockæ¥å£"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lockæ¥å£"}},[t._v("#")]),t._v(" Lockæ¥å£")]),t._v(" "),s("blockquote",[s("p",[t._v("å®šä¹‰äº†é”è·å–å’Œé‡Šæ”¾çš„ä¸€ç³»åˆ—æ“ä½œï¼Œå¹¶èƒ½æä¾›"),s("code",[t._v("synchronized")]),t._v("å…³é”®å­—ä¸å…·å¤‡çš„ç‰¹è´¨")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("å°è¯•éé˜»å¡åœ°è·å–é”")]),t._v("ï¼šå½“å‰çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¦‚æœè¿™ä¸€æ—¶åˆ»é”æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹è·å–åˆ°ï¼Œåˆ™æˆåŠŸè·å–å¹¶æŒæœ‰é”ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("èƒ½è¢«ä¸­æ–­åœ°è·å–é”")]),t._v("ï¼šä¸"),s("code",[t._v("synchronized")]),t._v("ä¸åŒï¼Œè·å–é”çš„çº¿ç¨‹èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œå½“è·å–åˆ°é”çš„çº¿ç¨‹è¢«ä¸­æ–­æ—¶ï¼Œä¸­æ–­å¼‚å¸¸å°†ä¼šè¢«æŠ›å‡ºï¼ŒåŒæ—¶é”ä¼šè¢«é‡Šæ”¾ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¶…æ—¶è·å–é”ğŸ”")]),t._v("ï¼šåœ¨æŒ‡å®šçš„æ—¶é—´ä¹‹å‰è·å–é”ï¼Œå¦‚æœæˆªæ­¢æ—¶é—´åˆ°äº†ä»æ—§æ— æ³•è·å¾—é”ï¼Œåˆ™è¿”å›ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"é˜Ÿåˆ—åŒæ­¥å™¨aqs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é˜Ÿåˆ—åŒæ­¥å™¨aqs"}},[t._v("#")]),t._v(" é˜Ÿåˆ—åŒæ­¥å™¨AQS")]),t._v(" "),s("p",[s("code",[t._v("AbstractQueuedSynchronizer")]),t._v("åˆè¢«ç§°ä¸º"),s("code",[t._v("AQS")]),t._v("ã€‚æä¾›æ¨¡æ¿æ–¹æ³•ï¼Œå…¶ä¸­"),s("code",[t._v("FailSync")]),t._v("å’Œ"),s("code",[t._v("nonFailSync")]),t._v("ç­‰éƒ½æ˜¯åŸºäºAQSå®ç°çš„ã€‚")]),t._v(" "),s("h3",{attrs:{id:"èƒ½å¤Ÿè¦†ç›–çš„æ¨¡æ¿æ–¹æ³•ã€‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#èƒ½å¤Ÿè¦†ç›–çš„æ¨¡æ¿æ–¹æ³•ã€‚"}},[t._v("#")]),t._v(" èƒ½å¤Ÿè¦†ç›–çš„æ¨¡æ¿æ–¹æ³•ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomLock")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AbstractQueuedSynchronizer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryAcquire")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryAcquire")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryRelease")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryRelease")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryAcquireShared")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryAcquireShared")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryReleaseShared")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryReleaseShared")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isHeldExclusively")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isHeldExclusively")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"reentrantlock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reentrantlock"}},[t._v("#")]),t._v(" "),s("code",[t._v("ReentrantLock")])]),t._v(" "),s("h4",{attrs:{id:"ä½¿ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨"}},[t._v("#")]),t._v(" ä½¿ç”¨")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éå…¬å¹³é”")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Lock")]),t._v(" lock "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReentrantLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å…¬å¹³é”")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// lock = new ReentrantLock(true);")]),t._v("\n    lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        count"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€åé‡Šæ”¾é”")]),t._v("\n        lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("é‡å…¥é”å’Œ"),s("code",[t._v("synchronized")]),t._v("å…³é”®å­—çš„åŒºåˆ«")]),t._v(" "),s("ul",[s("li",[t._v("é‡å…¥é”èƒ½å¤Ÿè¶…æ—¶è·å–é”ï¼Œå¹¶è§¦å‘ä¸­æ–­")]),t._v(" "),s("li",[t._v("é‡å…¥é”åˆ¤æ–­çš„æ˜¯"),s("code",[t._v("AQS")]),t._v("é‡Œçš„"),s("code",[t._v("state")]),t._v("å­—æ®µï¼Œè€Œ"),s("code",[t._v("synchronized")]),t._v("åˆ¤æ–­çš„æ˜¯å¯¹è±¡å¤´ã€‚ä¸¤è€…éƒ½é¿å…é”çš„è·å–ä¸åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´è¿›è¡Œåˆ‡æ¢")]),t._v(" "),s("li",[s("code",[t._v("synchronized")]),t._v("æ˜¯"),s("strong",[t._v("éå…¬å¹³é”")]),t._v("ï¼Œå¦‚æœè¦å®ç°å…¬å¹³é”ï¼Œåªèƒ½ä½¿ç”¨"),s("code",[t._v("ReentrantLock")])]),t._v(" "),s("li",[s("code",[t._v("synchronized")]),t._v("å…³é”®å­—å®ç°äº†åå‘é”ï¼Œè‡ªæ—‹é”ï¼Œæ€§èƒ½ä¸Šå’Œ"),s("code",[t._v("ReentrantLock")]),t._v("åŸºæœ¬ä¸€æ ·")]),t._v(" "),s("li",[s("code",[t._v("ReentrantLock")]),t._v("æä¾›äº†"),s("code",[t._v("newCondition")]),t._v("æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡"),s("code",[t._v("Condition.await()")]),t._v("å’Œ"),s("code",[t._v("Condition.signal()")]),t._v("æ–¹æ³•æ¥é˜»å¡å”¤é†’æŒ‡å®šçš„çº¿ç¨‹æˆ–æ˜¯çº¿ç¨‹ç»„")])]),t._v(" "),s("h4",{attrs:{id:"å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«"}},[t._v("#")]),t._v(" å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("å…¬å¹³é”ä¼šåœ¨æœ‰æ–°çš„çº¿ç¨‹è¿›æ¥çš„æ—¶å€™ï¼Œé¦–å…ˆåˆ¤æ–­ä¸‹é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åŠ å…¥é˜Ÿåˆ—")])]),t._v(" "),s("li",[s("p",[t._v("éå…¬å¹³é”ä¼šå…ˆå°è¯•è·å–é”ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œå°±åŠ å…¥é˜Ÿåˆ—ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("æ€§èƒ½ä¸Šï¼Œå…¬å¹³é”çš„æ€§èƒ½ä¼šæ¯”éå…¬å¹³é”ä½ï¼Œå› ä¸ºå…¬å¹³é”ä¼šå¯¼è‡´è¿‡å¤šçš„çº¿ç¨‹åˆ‡æ¢ï¼Œå½±å“ååç‡ã€‚ä½†æ˜¯éå…¬å¹³é”å¯èƒ½ä¼šå¯¼è‡´"),s("strong",[t._v("çº¿ç¨‹é¥¥é¥¿")]),t._v("çš„é—®é¢˜")])])]),t._v(" "),s("h3",{attrs:{id:"reentrantreadwritelock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reentrantreadwritelock"}},[t._v("#")]),t._v(" "),s("code",[t._v("ReentrantReadWriteLock")])]),t._v(" "),s("p",[s("code",[t._v("ReentrantLock")]),t._v("å’Œ"),s("code",[t._v("synchronized")]),t._v("å…³é”®å­—éƒ½æ˜¯"),s("strong",[t._v("æ’ä»–é”ï¼ˆç‹¬å é”ï¼‰")]),t._v("ï¼Œè¿™äº›é”åœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œè€Œè¯»å†™é”ï¼ˆ"),s("code",[t._v("ReentrantReadWriteLock")]),t._v("ï¼‰å¯ä»¥å…è®¸å¤šä¸ªçº¿ç¨‹è®¿é—®ã€‚**è¯»é”æ˜¯å…±äº«é”ï¼Œå†™é”æ˜¯æ’ä»–é”ã€‚è¯»é”å’Œå†™é”äº’æ–¥ã€‚**åœ¨æ€§èƒ½ä¸Š"),s("code",[t._v("ReentrantReadWriteLock")]),t._v("æ¯”"),s("code",[t._v("ReentrantLock")]),t._v("å¥½ã€‚")]),t._v(" "),s("p",[t._v("TODO")]),t._v(" "),s("h3",{attrs:{id:"stampedlock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stampedlock"}},[t._v("#")]),t._v(" "),s("code",[t._v("StampedLock")])]),t._v(" "),s("p",[s("code",[t._v("stamped")]),t._v("å°æœ‰å°ç« çš„å°è®°ï¼Œ"),s("strong",[t._v("ä¸æ˜¯é‡å…¥é”")]),t._v("ğŸ”’")]),t._v(" "),s("p",[s("code",[t._v("ReentrantReadWriteLock")]),t._v("ä½¿å¾—å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶æŒæœ‰è¯»é”ï¼ˆåªè¦å†™é”æœªè¢«å ç”¨ï¼‰ï¼Œè€Œå†™é”æ˜¯ç‹¬å çš„ã€‚")]),t._v(" "),s("p",[t._v("ä½†æ˜¯ï¼Œè¯»å†™é”å¦‚æœä½¿ç”¨ä¸å½“ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿâ€œé¥¥é¥¿â€é—®é¢˜ï¼š")]),t._v(" "),s("p",[t._v("æ¯”å¦‚åœ¨è¯»çº¿ç¨‹éå¸¸å¤šï¼Œå†™çº¿ç¨‹å¾ˆå°‘çš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å†™çº¿ç¨‹â€œé¥¥é¥¿â€ï¼Œè™½ç„¶ä½¿ç”¨â€œå…¬å¹³â€ç­–ç•¥å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯â€œå…¬å¹³â€ç­–ç•¥æ˜¯ä»¥ç‰ºç‰²ç³»ç»Ÿååé‡ä¸ºä»£ä»·çš„ã€‚")]),t._v(" "),s("h4",{attrs:{id:"stampedlockçš„ç‰¹ç‚¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stampedlockçš„ç‰¹ç‚¹"}},[t._v("#")]),t._v(" StampedLockçš„ç‰¹ç‚¹")]),t._v(" "),s("p",[s("code",[t._v("try")]),t._v("ç³»åˆ—è·å–é”çš„å‡½æ•°ï¼Œå½“è·å–é”å¤±è´¥åä¼šè¿”å›ä¸º0çš„"),s("code",[t._v("stamp")]),t._v("å€¼ã€‚å½“è°ƒç”¨é‡Šæ”¾é”å’Œè½¬æ¢é”çš„æ–¹æ³•æ—¶å€™éœ€è¦ä¼ å…¥è·å–é”æ—¶å€™è¿”å›çš„"),s("code",[t._v("stamp")]),t._v("å€¼ã€‚")]),t._v(" "),s("p",[s("code",[t._v("StampedLockd")]),t._v("çš„å†…éƒ¨å®ç°æ˜¯åŸºäº"),s("code",[t._v("CLH")]),t._v("é”çš„ï¼Œ"),s("code",[t._v("CLH")]),t._v("é”åŸç†ï¼šé”ç»´æŠ¤ç€ä¸€ä¸ªç­‰å¾…çº¿ç¨‹é˜Ÿåˆ—ï¼Œæ‰€æœ‰ç”³è¯·é”ä¸”å¤±è´¥çš„çº¿ç¨‹éƒ½è®°å½•åœ¨é˜Ÿåˆ—ã€‚ä¸€ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹ï¼Œ")]),t._v(" "),s("p",[t._v("ä¿å­˜ç€ä¸€ä¸ªæ ‡è®°ä½"),s("code",[t._v("locked")]),t._v(",ç”¨ä»¥åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»é‡Šæ”¾é”ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è·å–é”æ—¶ï¼Œä»é˜Ÿåˆ—å°¾èŠ‚ç‚¹ä½œä¸ºå‰åºèŠ‚ç‚¹ï¼Œå¾ªç¯åˆ¤æ–­æ‰€æœ‰çš„å‰åºèŠ‚ç‚¹æ˜¯å¦å·²ç»æˆåŠŸé‡Šæ”¾é”ã€‚")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1470988",target:"_blank",rel:"noopener noreferrer"}},[t._v("JDK8ä¸­æ–°å¢çš„StampedLock"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"locksupport"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#locksupport"}},[t._v("#")]),t._v(" "),s("code",[t._v("LockSupport")])]),t._v(" "),s("p",[t._v("ç”¨äºé˜»å¡æˆ–å”¤é†’çº¿ç¨‹")]),t._v(" "),s("p",[t._v("ç”¨æ³•")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é˜»å¡å½“å‰çº¿ç¨‹")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LockSupport")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("park")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// çº¿ç¨‹çš„åŠŸèƒ½ï¼Œå…¶ä¸­å‚æ•° blockeræ˜¯ç”¨æ¥æ ‡è¯†å½“å‰çº¿ç¨‹åœ¨ç­‰å¾…çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸»è¦ç”¨äºé—®é¢˜æ’æŸ¥å’Œç³»ç»Ÿç›‘æ§ã€‚")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LockSupport")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("park")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç­‰å¾…çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LockSupport")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parkNanos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// deadlineæ˜¯ç»å¯¹æ—¶é—´ï¼Œæ¯«ç§’")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LockSupport")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parkUntil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å”¤é†’çº¿ç¨‹")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LockSupport")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unpark")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"condition"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#condition"}},[t._v("#")]),t._v(" "),s("code",[t._v("Condition")])]),t._v(" "),s("p",[s("code",[t._v("Condition")]),t._v("æ˜¯"),s("code",[t._v("Lock#newCondition")]),t._v("åˆ›å»ºå‡ºæ¥çš„")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Lock")]),t._v(" lock "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReentrantLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Condition")]),t._v(" condition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newCondition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("conditionWait")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        condition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("conditionSignal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        condition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("signal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        lock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("TODO")]),t._v(" "),s("h2",{attrs:{id:"javaå¹¶å‘å®¹å™¨å’Œæ¡†æ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaå¹¶å‘å®¹å™¨å’Œæ¡†æ¶"}},[t._v("#")]),t._v(" Javaå¹¶å‘å®¹å™¨å’Œæ¡†æ¶")]),t._v(" "),s("h3",{attrs:{id:"concurrenthashmap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#concurrenthashmap"}},[t._v("#")]),t._v(" "),s("code",[t._v("ConcurrentHashMap")])]),t._v(" "),s("p",[t._v("TODO")]),t._v(" "),s("h3",{attrs:{id:"javaä¸­çš„é˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaä¸­çš„é˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" Javaä¸­çš„é˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[t._v("é˜»å¡é˜Ÿåˆ—æ˜¯ä¸€ä¸ªæ”¯æŒé˜»å¡çš„æ’å…¥å’Œç§»é™¤æ–¹æ³•çš„é˜Ÿåˆ—ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ”¯æŒé˜»å¡çš„æ’å…¥æ–¹æ³•ï¼šå½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œé˜»å¡æ’å…¥å…ƒç´ çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰å…ƒç´ è¢«ç§»é™¤")]),t._v(" "),s("li",[t._v("æ”¯æŒé˜»å¡çš„ç§»é™¤æ–¹æ³•ï¼šå½“é˜Ÿåˆ—ç©ºæ—¶ï¼Œè·å–é˜Ÿåˆ—å…ƒç´ çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ï¼ŒçŸ¥é“å–å¾—é˜Ÿåˆ—ä¸­çš„å…ƒç´ ")])]),t._v(" "),s("h4",{attrs:{id:"arrayblockingqueueæ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arrayblockingqueueæ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" "),s("code",[t._v("ArrayBlockingQueue")]),t._v("æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[t._v("æŒ‰ç…§FIFOçš„åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚å¯ä»¥é€‰æ‹©æ˜¯å¦ä¿è¯é˜Ÿåˆ—çš„å…¬å¹³æ€§ï¼Œè®¿é—®è€…çš„å…¬å¹³æ€§æ˜¯åŸºäºå¯é‡å…¥é”"),s("code",[t._v("ReentrantLock")]),t._v("å®ç°çš„")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayBlockingQueue")]),t._v(" fairQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayBlockingQueue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"linkedblockingqueueé“¾è¡¨å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linkedblockingqueueé“¾è¡¨å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" "),s("code",[t._v("LinkedBlockingQueue")]),t._v("é“¾è¡¨å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[t._v("é»˜è®¤é•¿åº¦å¹¶ä¸”æ˜¯æœ€å¤§é•¿åº¦ä¸º"),s("code",[t._v("Integer.MAX_VALUE")]),t._v("ã€‚"),s("strong",[t._v("FIFO")])]),t._v(" "),s("h4",{attrs:{id:"priorityblockingqueueæ”¯æŒä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—-æ•°ç»„å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#priorityblockingqueueæ”¯æŒä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—-æ•°ç»„å®ç°"}},[t._v("#")]),t._v(" "),s("code",[t._v("PriorityBlockingQueue")]),t._v("æ”¯æŒä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ•°ç»„å®ç°")]),t._v(" "),s("p",[t._v("é»˜è®¤æƒ…å†µä¸‹å…ƒç´ æŒ‰ç…§å‡åºæ’åºã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç±»å®ç°"),s("code",[t._v("compareTo()")]),t._v("æ–¹æ³•æ¥æŒ‡å®šå…ƒç´ æ’åºè§„åˆ™ï¼Œæˆ–è€…åœ¨åˆå§‹åŒ–"),s("code",[t._v("PriorityBlockingQueue")]),t._v("æ—¶ï¼ŒæŒ‡å®š"),s("code",[t._v("Comparator")]),t._v("æ¥å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚")]),t._v(" "),s("h4",{attrs:{id:"delayqueueæ”¯æŒå»¶æ—¶è·å–å…ƒç´ çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delayqueueæ”¯æŒå»¶æ—¶è·å–å…ƒç´ çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" "),s("code",[t._v("DelayQueue")]),t._v("æ”¯æŒå»¶æ—¶è·å–å…ƒç´ çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[t._v("æ˜¯"),s("code",[t._v("PriorityQueue")]),t._v("çš„å­ç±»")]),t._v(" "),s("h4",{attrs:{id:"synchronousqueueä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#synchronousqueueä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" "),s("code",[t._v("SynchronousQueue")]),t._v("ä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[t._v("æ¯ä¸€ä¸ª"),s("code",[t._v("put")]),t._v("æ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ª"),s("code",[t._v("take")]),t._v("æ“ä½œï¼Œå¦åˆ™ä¸èƒ½ç»§ç»­æ·»åŠ å…ƒç´ ã€‚å¯ä»¥æŠŠ"),s("code",[t._v("SynchronousQueue")]),t._v("çœ‹æˆä¼ çƒæ‰‹ï¼Œè´Ÿè´£æŠŠç”Ÿäº§è€…çº¿ç¨‹å¤„ç†çš„æ•°æ®ç›´æ¥ç»™æ¶ˆè´¹è€…çº¿ç¨‹ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SynchronousQueue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" fair"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    transferer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fair "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TransferQueue")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TransferStack")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"linkedtransferqueueé“¾è¡¨å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linkedtransferqueueé“¾è¡¨å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" "),s("code",[t._v("LinkedTransferQueue")]),t._v("é“¾è¡¨å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[t._v("ç›¸æ¯”äºå…¶ä»–é˜»å¡é˜Ÿåˆ—ï¼Œ"),s("code",[t._v("LinkedTransferQueue")]),t._v("å¤šäº†"),s("code",[t._v("tryTransfer")]),t._v("å’Œ"),s("code",[t._v("transfer")]),t._v("æ–¹æ³•ã€‚")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("transfer")]),t._v("æ–¹æ³•")]),t._v(" "),s("p",[t._v("å¦‚æœå½“å‰æœ‰æ¶ˆè´¹è€…æ­£åœ¨ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼ˆä½¿ç”¨"),s("code",[t._v("take()")]),t._v("æˆ–"),s("code",[t._v("poll()")]),t._v("æ–¹æ³•æ—¶ï¼‰ï¼Œ"),s("code",[t._v("transfer()")]),t._v("æ–¹æ³•å¯ä»¥æŠŠç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ ç«‹åˆ»"),s("code",[t._v("transfer")]),t._v("ç»™æ¶ˆè´¹è€…ã€‚å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…åœ¨ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œ"),s("code",[t._v("transfer")]),t._v("ä¼šå°†å…ƒç´ æ”¾åœ¨é˜Ÿåˆ—çš„"),s("code",[t._v("tail")]),t._v("èŠ‚ç‚¹ï¼Œ"),s("strong",[t._v("å¹¶ç­‰å¾…è¢«æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›")]),t._v("ã€‚")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("tryTransfer")]),t._v("æ–¹æ³•")]),t._v(" "),s("p",[s("code",[t._v("tryTransfer")]),t._v("æ–¹æ³•æ˜¯ç”¨æ¥è¯•æ¢ç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ æ˜¯å¦èƒ½ç›´æ¥ä¼ ç»™æ¶ˆè´¹è€…ã€‚å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œåˆ™è¿”å›"),s("code",[t._v("false")]),t._v("ã€‚å’Œ"),s("code",[t._v("transfer")]),t._v("æ–¹æ³•çš„åŒºåˆ«æ˜¯"),s("code",[t._v("tryTransfer")]),t._v("æ–¹æ³•æ— è®ºæ¶ˆè´¹è€…æ˜¯å¦æ¥æ”¶ï¼Œæ–¹æ³•ç«‹å³è¿”å›ï¼Œè€Œ"),s("code",[t._v("transfer")]),t._v("æ–¹æ³•æ˜¯å¿…é¡»ç­‰åˆ°æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›ã€‚")])])]),t._v(" "),s("h4",{attrs:{id:"linkedblockingdueueé“¾è¡¨å®ç°çš„åŒå‘é˜»å¡é˜Ÿåˆ—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linkedblockingdueueé“¾è¡¨å®ç°çš„åŒå‘é˜»å¡é˜Ÿåˆ—"}},[t._v("#")]),t._v(" "),s("code",[t._v("LinkedBlockingDueue")]),t._v("é“¾è¡¨å®ç°çš„åŒå‘é˜»å¡é˜Ÿåˆ—")]),t._v(" "),s("p",[s("code",[t._v("LinkedBlockingDeque")]),t._v("æ˜¯ä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚æ‰€è°“åŒå‘é˜Ÿåˆ—æŒ‡çš„æ˜¯å¯ä»¥ä»é˜Ÿåˆ—çš„ä¸¤ç«¯æ’å…¥å’Œç§»å‡ºå…ƒç´ ã€‚åŒå‘é˜Ÿåˆ—å› ä¸ºå¤šäº†ä¸€ä¸ªæ“ä½œé˜Ÿåˆ—çš„å…¥å£ï¼Œåœ¨å¤šçº¿ç¨‹åŒæ—¶å…¥é˜Ÿæ—¶ï¼Œä¹Ÿå°±å‡å°‘äº†ä¸€åŠçš„ç«äº‰ã€‚ç›¸æ¯”å…¶ä»–çš„é˜»å¡é˜Ÿåˆ—ï¼Œ"),s("code",[t._v("LinkedBlockingDeque")]),t._v("å¤šäº†"),s("code",[t._v("addFirstã€addLastã€offerFirstã€offerLastã€peekFirst")]),t._v("å’Œ"),s("code",[t._v("peekLast")]),t._v("ç­‰æ–¹æ³•ï¼Œä»¥"),s("code",[t._v("First")]),t._v("å•è¯ç»“å°¾çš„æ–¹æ³•ï¼Œè¡¨ç¤ºæ’å…¥ã€è·å–ï¼ˆ"),s("code",[t._v("peek")]),t._v("ï¼‰æˆ–ç§»é™¤åŒç«¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ä»¥Lastå•è¯ç»“å°¾çš„æ–¹æ³•ï¼Œè¡¨ç¤ºæ’å…¥ã€è·å–æˆ–ç§»é™¤åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦å¤–ï¼Œæ’å…¥æ–¹æ³•"),s("code",[t._v("add")]),t._v("ç­‰åŒäº"),s("code",[t._v("addLast")]),t._v("ï¼Œç§»é™¤æ–¹æ³•"),s("code",[t._v("remove")]),t._v("ç­‰æ•ˆäº"),s("code",[t._v("removeFirst")]),t._v("ã€‚ä½†æ˜¯"),s("code",[t._v("take")]),t._v("æ–¹æ³•å´ç­‰åŒäº"),s("code",[t._v("takeFirst")]),t._v("ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯JDKçš„bugï¼Œä½¿ç”¨æ—¶è¿˜æ˜¯ç”¨å¸¦æœ‰Firstå’Œ"),s("code",[t._v("Last")]),t._v("åç¼€çš„æ–¹æ³•æ›´æ¸…æ¥šã€‚åœ¨åˆå§‹åŒ–"),s("code",[t._v("LinkedBlockingDeque")]),t._v("æ—¶å¯ä»¥è®¾ç½®å®¹é‡é˜²æ­¢å…¶è¿‡åº¦è†¨èƒ€ã€‚")]),t._v(" "),s("p",[t._v("å¦å¤–ï¼ŒåŒå‘é˜»å¡é˜Ÿåˆ—å¯ä»¥è¿ç”¨åœ¨â€œå·¥ä½œçªƒå–â€æ¨¡å¼ä¸­ã€‚")]),t._v(" "),s("h4",{attrs:{id:"concurrentlinkendqueue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#concurrentlinkendqueue"}},[t._v("#")]),t._v(" "),s("code",[t._v("ConcurrentLinkendQueue")])]),t._v(" "),s("p",[t._v("TODO")]),t._v(" "),s("h3",{attrs:{id:"fork-joinæ¡†æ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fork-joinæ¡†æ¶"}},[t._v("#")]),t._v(" Fork/Joinæ¡†æ¶")]),t._v(" "),s("p",[s("code",[t._v("Fork/Join")]),t._v("æ¡†æ¶æ˜¯Java7æä¾›çš„ä¸€ä¸ªç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼Œæœ€ç»ˆæ±‡æ€»æ¯ä¸ªå°ä»»åŠ¡ç»“æœåå¾—åˆ°å¤§ä»»åŠ¡ç»“æœçš„æ¡†æ¶ã€‚")]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a54a24",graph:t.$dataBlock.mermaid_64a54a24}}),s("h4",{attrs:{id:"å·¥ä½œçªƒå–ç®—æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å·¥ä½œçªƒå–ç®—æ³•"}},[t._v("#")]),t._v(" å·¥ä½œçªƒå–ç®—æ³•")]),t._v(" "),s("p",[t._v("åŒå‘é˜Ÿåˆ—ï¼Œè¢«çªƒå–çš„ä»»åŠ¡çº¿ç¨‹æ°¸è¿œä»åŒå‘é˜Ÿåˆ—çš„å¤´éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œï¼Œè€Œçªƒå–ä»»åŠ¡çš„çº¿ç¨‹æ°¸è¿œä»åŒå‘é˜Ÿåˆ—çš„å°¾éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œã€‚")]),t._v(" "),s("h4",{attrs:{id:"ä½¿ç”¨-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-2"}},[t._v("#")]),t._v(" ä½¿ç”¨")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@AllArgsConstructor")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountTask")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RecursiveTask")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" threshold "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" end"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("compute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" sum "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("end "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" start "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" threshold"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" end"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                sum "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" mid "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("end "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountTask")]),t._v(" t1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountTask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountTask")]),t._v(" t2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountTask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            t1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fork")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            t2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fork")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            sum "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" t2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" sum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecutionException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ForkJoinPool")]),t._v(" forkJoinPool "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ForkJoinPool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ForkJoinTask")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" submit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" forkJoinPool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountTask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" ret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" submit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"_13ä¸ªåŸå­æ“ä½œç±»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_13ä¸ªåŸå­æ“ä½œç±»"}},[t._v("#")]),t._v(" 13ä¸ªåŸå­æ“ä½œç±»")]),t._v(" "),s("h3",{attrs:{id:"åŸºæœ¬ç±»å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬ç±»å‹"}},[t._v("#")]),t._v(" åŸºæœ¬ç±»å‹")]),t._v(" "),s("h4",{attrs:{id:"atomicboolean"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicboolean"}},[t._v("#")]),t._v(" AtomicBoolean")]),t._v(" "),s("h4",{attrs:{id:"atomicinteger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicinteger"}},[t._v("#")]),t._v(" AtomicInteger")]),t._v(" "),s("h4",{attrs:{id:"atomiclong"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomiclong"}},[t._v("#")]),t._v(" AtomicLong")]),t._v(" "),s("h3",{attrs:{id:"æ•°ç»„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ•°ç»„"}},[t._v("#")]),t._v(" æ•°ç»„")]),t._v(" "),s("h4",{attrs:{id:"atomicintegerarray"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicintegerarray"}},[t._v("#")]),t._v(" AtomicIntegerArray")]),t._v(" "),s("h4",{attrs:{id:"atomicreferencearray"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicreferencearray"}},[t._v("#")]),t._v(" AtomicReferenceArray")]),t._v(" "),s("h4",{attrs:{id:"atomiclongarray"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomiclongarray"}},[t._v("#")]),t._v(" AtomicLongArray")]),t._v(" "),s("h3",{attrs:{id:"å¼•ç”¨ç±»å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¼•ç”¨ç±»å‹"}},[t._v("#")]),t._v(" å¼•ç”¨ç±»å‹")]),t._v(" "),s("h4",{attrs:{id:"atomicmarkablereference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicmarkablereference"}},[t._v("#")]),t._v(" AtomicMarkableReference")]),t._v(" "),s("h4",{attrs:{id:"atomicreference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicreference"}},[t._v("#")]),t._v(" AtomicReference")]),t._v(" "),s("h4",{attrs:{id:"atomicstampedreference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicstampedreference"}},[t._v("#")]),t._v(" AtomicStampedReference")]),t._v(" "),s("h3",{attrs:{id:"æ›´æ–°å­—æ®µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°å­—æ®µ"}},[t._v("#")]),t._v(" æ›´æ–°å­—æ®µ")]),t._v(" "),s("h4",{attrs:{id:"atomiclongfieldupdater"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomiclongfieldupdater"}},[t._v("#")]),t._v(" AtomicLongFieldUpdater")]),t._v(" "),s("h4",{attrs:{id:"atomicintegerfieldupdater"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicintegerfieldupdater"}},[t._v("#")]),t._v(" AtomicIntegerFieldUpdater")]),t._v(" "),s("h4",{attrs:{id:"atomicreferencefieldupdater"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#atomicreferencefieldupdater"}},[t._v("#")]),t._v(" AtomicReferenceFieldUpdater")]),t._v(" "),s("h2",{attrs:{id:"å¹¶å‘å·¥å…·ç±»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¹¶å‘å·¥å…·ç±»"}},[t._v("#")]),t._v(" å¹¶å‘å·¥å…·ç±»")]),t._v(" "),s("h3",{attrs:{id:"ç­‰å¾…å¤šçº¿ç¨‹å®Œæˆçš„countdownlatch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç­‰å¾…å¤šçº¿ç¨‹å®Œæˆçš„countdownlatch"}},[t._v("#")]),t._v(" ç­‰å¾…å¤šçº¿ç¨‹å®Œæˆçš„"),s("code",[t._v("CountDownLatch")])]),t._v(" "),s("p",[s("code",[t._v("CountDownLatch")]),t._v("çš„æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ª"),s("code",[t._v("int")]),t._v("å‚æ•°ä½œä¸ºè®¡æ•°å™¨ï¼Œè¡¨ç¤ºç­‰å¾…Nä¸ªç‚¹å®Œæˆã€‚å½“è°ƒç”¨"),s("code",[t._v("countDown")]),t._v("æ–¹æ³•æ—¶ï¼Œè®¡æ•°å™¨å°±ä¼šå‡ä¸€ã€‚ è¿™é‡Œçš„Nä¸ªç‚¹ï¼Œå¯ä»¥æ˜¯Nä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯1ä¸ªçº¿ç¨‹é‡Œçš„Nä¸ªæ‰§è¡Œæ­¥éª¤ã€‚ä¾‹å¦‚è§£æ"),s("code",[t._v("Excel")]),t._v("çš„sheetã€‚")]),t._v(" "),s("h4",{attrs:{id:"ä½¿ç”¨-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-3"}},[t._v("#")]),t._v(" ä½¿ç”¨")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatchTester")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),t._v(" countDownLatch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        countDownLatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDown")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            countDownLatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDown")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"çº¿ç¨‹å†…æ‰“å°"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                countDownLatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDown")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        countDownLatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"åŒæ­¥å±éšœcyclicbarrier"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŒæ­¥å±éšœcyclicbarrier"}},[t._v("#")]),t._v(" åŒæ­¥å±éšœ"),s("code",[t._v("CyclicBarrier")])]),t._v(" "),s("p",[s("code",[t._v("CyclicBarrier")]),t._v("çš„å­—é¢æ„æ€æ˜¯å¯å¾ªç¯ä½¿ç”¨ï¼ˆ"),s("code",[t._v("Cyclic")]),t._v("ï¼‰çš„å±éšœï¼ˆ"),s("code",[t._v("Barrier")]),t._v("ï¼‰ã€‚ä¸»è¦ä½œç”¨æ˜¯è®©ä¸€ç»„çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå±éšœï¼ˆä¹Ÿå¯ä»¥å«åŒæ­¥ç‚¹ï¼‰æ—¶è¢«é˜»å¡ï¼Œç›´åˆ°æœ€åä¸€ä¸ªçº¿ç¨‹ï¼ˆåŒ…æ‹¬ä¸»çº¿ç¨‹ï¼‰åˆ°è¾¾å±éšœæ—¶ï¼Œå±éšœæ‰ä¼šå¼€é—¨ï¼Œæ‰€æœ‰è¢«æ‹¦æˆªçš„çº¿ç¨‹æ‰ä¼šç»§ç»­è¿è¡Œã€‚")]),t._v(" "),s("p",[t._v("å’Œ"),s("code",[t._v("CountDownLatch")]),t._v("ç›¸æ¯”ï¼Œ"),s("code",[t._v("CyclicBarrier")]),t._v("å¯ä»¥è¢«é‡å¤ä½¿ç”¨ï¼Œè¿˜æä¾›ä¸€äº›äº†è§£é˜»å¡çº¿ç¨‹ä¿¡æ¯çš„æ–¹æ³•ã€‚")]),t._v(" "),s("h4",{attrs:{id:"ä½¿ç”¨-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-4"}},[t._v("#")]),t._v(" ä½¿ç”¨")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CyclicBarrierTester")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CyclicBarrier")]),t._v(" cyclicBarrier "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CyclicBarrier")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sub thread"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                cyclicBarrier"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sub thread were finished"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrokenBarrierException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é‡ç½®æ–¹æ³•")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cyclicBarrier.reset();")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–é˜»å¡çš„çº¿ç¨‹æ•°é‡çš„æ–¹æ³•")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cyclicBarrier.getNumberWaiting();")]),t._v("\n        cyclicBarrier"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sub thread were finished"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°semaphore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°semaphore"}},[t._v("#")]),t._v(" æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°"),s("code",[t._v("Semaphore")])]),t._v(" "),s("p",[s("code",[t._v("Semaphore")]),t._v("ä¿¡å·é‡ã€‚æ˜¯ç”¨æ¥æ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡ï¼Œå®ƒé€šè¿‡åè°ƒå„ä¸ªçº¿ç¨‹ï¼Œä»¥ä¿è¯åˆç†çš„ä½¿ç”¨å…¬å…±èµ„æºã€‚")]),t._v(" "),s("h3",{attrs:{id:"ä½¿ç”¨-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-5"}},[t._v("#")]),t._v(" ä½¿ç”¨")]),t._v(" "),s("p",[s("code",[t._v("Semaphore")]),t._v("å¯ä»¥ç”¨æ¥åšæµé‡æ§åˆ¶ã€‚åŠ å…¥æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œè¦è¯»å–å‡ ä¸‡ä¸ªæ–‡ä»¶çš„æ•°æ®ï¼Œå› ä¸ºéƒ½æ˜¯IOå¯†é›†å‹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨å‡ åä¸ªçº¿ç¨‹å¹¶å‘çš„å»è¯»å–ï¼Œä½†æ˜¯å¦‚æœè¯»åˆ°å†…å­˜åï¼Œè¿˜éœ€è¦å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œè€Œæ•°æ®åº“è¿æ¥æ•°åªæœ‰10ä¸ªï¼Œè¿™æ—¶æˆ‘ä»¬å¿…é¡»æ§åˆ¶åªæœ‰10ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å–æ•°æ®åº“é“¾æ¥æ¥ä¿å­˜æ•°æ®ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SemaphoreTester")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" THREAD_COUNT "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecutorService")]),t._v(" executorService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Executors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newFixedThreadPool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("THREAD_COUNT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€ååªèƒ½æœ‰10ä¸ªçº¿ç¨‹è·å–åˆ°æ•°æ®åº“è¿æ¥æ± ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Semaphore")]),t._v(" semaphore "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Semaphore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" THREAD_COUNT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            executorService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    semaphore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("acquire")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æ¨¡æ‹Ÿæ’å…¥æ•°æ®åˆ°æ•°æ®åº“"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    semaphore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("release")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼šç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆæ‰ä¼šå…³é—­")]),t._v("\n        executorService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"çº¿ç¨‹é—´äº¤æ¢æ•°æ®çš„exchanger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹é—´äº¤æ¢æ•°æ®çš„exchanger"}},[t._v("#")]),t._v(" çº¿ç¨‹é—´äº¤æ¢æ•°æ®çš„"),s("code",[t._v("Exchanger")])]),t._v(" "),s("p",[s("code",[t._v("Exchanger")]),t._v("ï¼ˆäº¤æ¢è€…ï¼‰æ˜¯ä¸€ä¸ªç”¨äºçº¿ç¨‹é—´åä½œï¼Œè¿›è¡Œæ•°æ®äº¤æ¢çš„å·¥å…·ç±»ã€‚å®ƒæä¾›ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œåœ¨è¿™ä¸ªåŒæ­¥ç‚¹ï¼Œä¸¤ä¸ªçº¿ç¨‹å¯ä»¥äº¤æ¢å½¼æ­¤çš„æ•°æ®ã€‚è¿™ä¸¤ä¸ªçº¿ç¨‹é€šè¿‡"),s("code",[t._v("exchange")]),t._v("æ–¹æ³•"),s("strong",[t._v("äº¤æ¢æ•°æ®")]),t._v("ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExchangerTester")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecutorService")]),t._v(" executorService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Executors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newFixedThreadPool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exchanger")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" exchanger "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exchanger")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        executorService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" exchanger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exchange")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wdnmd"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"first thread: "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        executorService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" exchanger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exchange")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"second thread: "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼šç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆæ‰ä¼šå…³é—­")]),t._v("\n        executorService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// second thread: wdnmd")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// first thread: C")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"çº¿ç¨‹æ± "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± "}},[t._v("#")]),t._v(" çº¿ç¨‹æ± ")]),t._v(" "),s("h3",{attrs:{id:"å‚æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚æ•°"}},[t._v("#")]),t._v(" å‚æ•°")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("corePoolSize")]),t._v(" â€“ the number of threads to keep in the pool, even if they are idle, unless allowCoreThreadTimeOut is set")]),t._v(" "),s("li",[s("code",[t._v("maximumPoolSize")]),t._v(" â€“ the maximum number of threads to allow in the pool")]),t._v(" "),s("li",[s("code",[t._v("keepAliveTime")]),t._v(" â€“ å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒæ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹åœ¨ç»ˆæ­¢å‰ç­‰å¾…æ–°ä»»åŠ¡çš„æœ€é•¿æ—¶é—´ã€‚")]),t._v(" "),s("li",[s("code",[t._v("unit")]),t._v(" â€“ the time unit for the keepAliveTime argument")]),t._v(" "),s("li",[s("code",[t._v("workQueue")]),t._v(" â€“ the queue to use for holding tasks before they are executed. This queue will hold only the Runnable tasks submitted by the execute method.")]),t._v(" "),s("li",[s("code",[t._v("threadFactory")]),t._v(" â€“ the factory to use when the executor creates a new threadï¼Œé»˜è®¤"),s("code",[t._v("DefaultThreadFactory")])]),t._v(" "),s("li",[s("code",[t._v("handler")]),t._v(" â€“ the handler to use when execution is blocked because the thread bounds and queue capacities are reachedï¼Œ é»˜è®¤æ˜¯"),s("code",[t._v("AbortPolicy")])])]),t._v(" "),s("h3",{attrs:{id:"çº¿ç¨‹æ± çš„å¥½å¤„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± çš„å¥½å¤„"}},[t._v("#")]),t._v(" çº¿ç¨‹æ± çš„å¥½å¤„")]),t._v(" "),s("ol",[s("li",[t._v("é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—")]),t._v(" "),s("li",[t._v("æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°åˆ›å»ºçº¿ç¨‹å°±èƒ½ç«‹å³æ‰§è¡Œ")]),t._v(" "),s("li",[t._v("æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§")])]),t._v(" "),s("h3",{attrs:{id:"çº¿ç¨‹æ± çš„ä¸»è¦å¤„ç†æµç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± çš„ä¸»è¦å¤„ç†æµç¨‹"}},[t._v("#")]),t._v(" çº¿ç¨‹æ± çš„ä¸»è¦å¤„ç†æµç¨‹")]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a53bd2",graph:t.$dataBlock.mermaid_64a53bd2}}),s("h3",{attrs:{id:"çº¿ç¨‹æ± çš„çŠ¶æ€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± çš„çŠ¶æ€"}},[t._v("#")]),t._v(" çº¿ç¨‹æ± çš„çŠ¶æ€")]),t._v(" "),s("p",[t._v("çº¿ç¨‹çŠ¶æ€å–çš„æ˜¯å˜é‡"),s("code",[t._v("ctl")]),t._v("çš„æœ€é«˜ä¸‰ä½ï¼Œå‰©ä¸‹çš„29ä½è®°å½•wokerçš„æ•°é‡")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("state")]),t._v(" "),s("th",[t._v("description")]),t._v(" "),s("th",[t._v("å€¼")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("RUNNING")]),t._v(" "),s("td",[t._v("æ¥æ”¶æ–°ä»»åŠ¡ï¼Œå¹¶å¤„ç†æ’é˜Ÿä»»åŠ¡")]),t._v(" "),s("td",[t._v("111")])]),t._v(" "),s("tr",[s("td",[t._v("SHUTDOWN")]),t._v(" "),s("td",[t._v("ä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä½†å¤„ç†æ’é˜Ÿä»»åŠ¡")]),t._v(" "),s("td",[t._v("000")])]),t._v(" "),s("tr",[s("td",[t._v("STOP")]),t._v(" "),s("td",[t._v("ä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä¸å¤„ç†æ’é˜Ÿä»»åŠ¡ï¼Œå¹¶ä¸­æ–­æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡")]),t._v(" "),s("td",[t._v("001")])]),t._v(" "),s("tr",[s("td",[t._v("tidying")]),t._v(" "),s("td",[t._v("æ‰€æœ‰ä»»åŠ¡ç»ˆæ­¢ï¼ŒworkerCount=0ï¼Œè½¬æ¢åˆ°tidyingçŠ¶æ€çš„ä»»åŠ¡å°†ä¼šæ‰§è¡Œterminate()çš„é’©å­æ–¹æ³•")]),t._v(" "),s("td",[t._v("010")])]),t._v(" "),s("tr",[s("td",[t._v("terminated")]),t._v(" "),s("td",[t._v("terminated()æ–¹æ³•å·²å®Œæˆ")]),t._v(" "),s("td",[t._v("011")])])])]),t._v(" "),s("ul",[s("li",[t._v("è°ƒç”¨"),s("code",[t._v("shutdown")]),t._v("æ–¹æ³•ï¼Œ"),s("code",[t._v("RUNNING")]),t._v("çŠ¶æ€è½¬ä¸º"),s("code",[t._v("SHUTDOWN")]),t._v("ã€‚å½“"),s("strong",[t._v("çº¿ç¨‹æ± å’Œé˜Ÿåˆ—éƒ½ä¸ºç©º")]),t._v("çš„æ—¶å€™ï¼ŒçŠ¶æ€å˜ä¸º"),s("code",[t._v("TIDYING")])]),t._v(" "),s("li",[t._v("è°ƒç”¨"),s("code",[t._v("shutdownNow")]),t._v("æ–¹æ³•ï¼Œ"),s("code",[t._v("RUNNING")]),t._v("çŠ¶æ€è½¬ä¸º"),s("code",[t._v("STOP")]),t._v("ã€‚å½“"),s("strong",[t._v("çº¿ç¨‹æ± ä¸ºç©º")]),t._v("æ—¶ï¼ŒçŠ¶æ€å˜ä¸º"),s("code",[t._v("TIDYING")])]),t._v(" "),s("li",[t._v("å½“è°ƒç”¨"),s("code",[t._v("terminate()")]),t._v("é’©å­æ–¹æ³•å®Œæˆåï¼ŒawaitTerminateæ–¹æ³•ä¸­çš„çº¿ç¨‹çŠ¶æ€éƒ½å˜ä¸º"),s("code",[t._v("terminate")]),t._v("åã€‚çŠ¶æ€ä»"),s("code",[t._v("TIDYING")]),t._v("å˜ä¸º"),s("code",[t._v("terminated")]),t._v("ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥"}},[t._v("#")]),t._v(" çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("AbortPolicy")]),t._v("ï¼šç›´æ¥æ‹’ç»ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼š"),s("code",[t._v("RejectedExecutionException")])]),t._v(" "),s("li",[s("code",[t._v("DiscardPolicy")]),t._v("ï¼šæ‹’ç»åŠ å…¥çš„ä»»åŠ¡ï¼Œä½†æ˜¯æ˜¯é™é»˜çš„ï¼Œä¸æŠ›å‡ºä»»ä½•å¼‚å¸¸")]),t._v(" "),s("li",[s("code",[t._v("DiscardOldestPolicy")]),t._v("ï¼šå¿½ç•¥ï¼ˆä¸¢å¼ƒï¼‰ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¦‚æœåˆšå¥½æœ‰å¯ç”¨çš„çº¿ç¨‹ï¼Œåˆ™ç«‹å³æäº¤æ‰§è¡Œã€‚")]),t._v(" "),s("li",[s("code",[t._v("CallerRunsPolicy")]),t._v("ï¼šè¢«æ‹’ç»ä»»åŠ¡çš„å¤„ç†ç¨‹åºï¼Œå®ƒç›´æ¥åœ¨executeæ–¹æ³•çš„"),s("strong",[t._v("è°ƒç”¨çº¿ç¨‹ä¸­è¿è¡Œ")]),t._v("è¢«æ‹’ç»çš„ä»»åŠ¡ï¼Œé™¤éæ‰§è¡Œç¨‹åºå·²å…³é—­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä»»åŠ¡å°†è¢«ä¸¢å¼ƒã€‚")])]),t._v(" "),s("h3",{attrs:{id:"çº¿ç¨‹æ± 10é—®10ç­”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± 10é—®10ç­”"}},[t._v("#")]),t._v(" çº¿ç¨‹æ± 10é—®10ç­”")]),t._v(" "),s("ol",[s("li",[s("h4",{attrs:{id:"corepoolsize-0ä¼šæ€ä¹ˆæ ·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#corepoolsize-0ä¼šæ€ä¹ˆæ ·"}},[t._v("#")]),t._v(" corePoolSize=0ä¼šæ€ä¹ˆæ ·")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// execute(Runable command) æ–¹æ³•")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("workerCountOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" corePoolSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// workQueue.offer(command) æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œå¦‚æœæ·»åŠ æˆåŠŸï¼Œè¿”å›false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isRunning")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" workQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("offer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" recheck "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç¬¬ä¸€ä¸ªsubmitçš„runableï¼Œ!isRunningä¼šè¿”å›false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isRunning")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("workerCountOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœå·¥ä½œçº¿ç¨‹æ•°é‡ä¸º0ï¼Œ åˆ™ç›´æ¥æ·»åŠ ä¸€ä¸ªéæ ¸å¿ƒå·¥ä½œçº¿ç¨‹")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("å› æ­¤å¯ä»¥çŸ¥é“ä¸‹é¢è¿™æ®µä»£ç å…¶å®ä¹Ÿæ˜¯ä¼šæ‰§è¡Œï¼Œå¹¶æ‰“å°ä¿¡æ¯çš„ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LinkedBlockingQueue")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" objects "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LinkedBlockingQueue")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadPoolExecutor")]),t._v(" threadPoolExecutor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadPoolExecutor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TimeUnit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SECONDS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" objects"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" finalI "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    threadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SneakyThrows")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("finalI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nthreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("corePoolSize")]),t._v("å’Œ"),s("code",[t._v("maximumPoolSize")]),t._v("éƒ½è®¾ä¸º0ï¼Œ ä¼šæŠ›å‡ºéæ³•å‚æ•°å¼‚å¸¸")])])])]),t._v(" "),s("li",[s("h4",{attrs:{id:"çº¿ç¨‹æ± åˆ›å»ºçš„ä¹‹å-ä¼šç«‹å³åˆ›å»ºçº¿ç¨‹æ± å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹æ± åˆ›å»ºçš„ä¹‹å-ä¼šç«‹å³åˆ›å»ºçº¿ç¨‹æ± å—"}},[t._v("#")]),t._v(" çº¿ç¨‹æ± åˆ›å»ºçš„ä¹‹åï¼Œä¼šç«‹å³åˆ›å»ºçº¿ç¨‹æ± å—")]),t._v(" "),s("p",[s("strong",[t._v("ä¸ä¼š")]),t._v("ã€‚ä»ä¸Šé¢çš„æºç å¯ä»¥çœ‹å‡ºï¼Œåˆ›å»ºå®Œ"),s("code",[t._v("ThreadPoolExecutor")]),t._v("ä¹‹åï¼Œçº¿ç¨‹ä¸ä¼šç«‹å³å¯åŠ¨ï¼Œè€Œæ˜¯è¦ç­‰åˆ°æœ‰ä»»åŠ¡æäº¤çš„æ—¶å€™æ‰ä¼šå¯åŠ¨ï¼Œé™¤éè°ƒç”¨äº†"),s("code",[t._v("prestartCoreThread")]),t._v("æˆ–è€…æ˜¯"),s("code",[t._v("prestartAllCoreThreads")]),t._v("æ‰ä¼šäº‹å…ˆå¯åŠ¨çº¿ç¨‹ã€‚")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("prestartCoreThread")]),t._v("ï¼šåªé¢„å¯åŠ¨ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œå¦‚æœæ ¸å¿ƒçº¿ç¨‹è®¾ä¸º0ï¼Œåˆ™ä¸ä¼šé¢„å…ˆå¯åŠ¨ä»»ä½•çº¿ç¨‹")]),t._v(" "),s("li",[s("code",[t._v("prestartAllCoreThreads")]),t._v("ï¼šå¯åŠ¨æ‰€æœ‰çš„æ ¸å¿ƒçº¿ç¨‹ï¼Œå¦‚æœæ ¸å¿ƒçº¿ç¨‹è®¾ä¸º0ï¼Œåˆ™ä¸ä¼šé¢„å…ˆå¯åŠ¨ä»»ä½•çº¿ç¨‹")])])]),t._v(" "),s("li",[s("h4",{attrs:{id:"æ ¸å¿ƒçº¿ç¨‹æ°¸è¿œä¸ä¼šé”€æ¯å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ ¸å¿ƒçº¿ç¨‹æ°¸è¿œä¸ä¼šé”€æ¯å—"}},[t._v("#")]),t._v(" æ ¸å¿ƒçº¿ç¨‹æ°¸è¿œä¸ä¼šé”€æ¯å—ï¼Ÿ")]),t._v(" "),s("p",[t._v("åœ¨JDK1.6ä¹‹åï¼Œå¦‚æœallowsCoreThreadTimeOut=trueï¼Œæ ¸å¿ƒçº¿ç¨‹ä¹Ÿå¯ä»¥è¢«ç»ˆæ­¢ã€‚")])]),t._v(" "),s("li",[s("h4",{attrs:{id:"å¦‚ä½•ä¿è¯çº¿ç¨‹ä¸è¢«é”€æ¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•ä¿è¯çº¿ç¨‹ä¸è¢«é”€æ¯"}},[t._v("#")]),t._v(" å¦‚ä½•ä¿è¯çº¿ç¨‹ä¸è¢«é”€æ¯")]),t._v(" "),s("p",[t._v("å®ç°æ–¹å¼éå¸¸å·§å¦™ï¼Œæ ¸å¿ƒçº¿ç¨‹ï¼ˆWorkerï¼‰å³ä½¿ä¸€ç›´ç©ºé—²ä¹Ÿä¸ç»ˆæ­¢ï¼Œæ˜¯é€šè¿‡workQueue.take()å®ç°çš„ï¼Œå®ƒä¼šä¸€ç›´é˜»å¡åˆ°ä»ç­‰å¾…é˜Ÿåˆ—ä¸­å–åˆ°æ–°çš„ä»»åŠ¡ã€‚éæ ¸å¿ƒçº¿ç¨‹ç©ºé—²æŒ‡å®šæ—¶é—´åç»ˆæ­¢æ˜¯é€šè¿‡workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS)å®ç°çš„ï¼Œä¸€ä¸ªç©ºé—²çš„Workeråªç­‰å¾…keepAliveTimeï¼Œå¦‚æœè¿˜æ²¡æœ‰å–åˆ°ä»»åŠ¡åˆ™å¾ªç¯ç»ˆæ­¢ï¼Œçº¿ç¨‹ä¹Ÿå°±è¿è¡Œç»“æŸäº†ã€‚")])]),t._v(" "),s("li",[s("h4",{attrs:{id:"ç©ºé—²çº¿ç¨‹è¿‡å¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç©ºé—²çº¿ç¨‹è¿‡å¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜"}},[t._v("#")]),t._v(" ç©ºé—²çº¿ç¨‹è¿‡å¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("çº¿ç¨‹æ± ä¿æŒç©ºé—²çš„æ ¸å¿ƒçº¿ç¨‹æ˜¯å®ƒçš„é»˜è®¤é…ç½®ï¼Œä¸€èˆ¬æ¥è®²æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå®ƒå ç”¨çš„å†…å­˜ä¸€èˆ¬ä¸å¤§ã€‚æ€•çš„å°±æ˜¯ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨ThreadLocalç¼“å­˜çš„æ•°æ®è¿‡å¤§åˆä¸æ¸…ç†ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("å¦‚æœä½ çš„åº”ç”¨çº¿ç¨‹æ•°å¤„äºé«˜ä½ï¼Œé‚£ä¹ˆéœ€è¦è§‚å¯Ÿä¸€ä¸‹YoungGCçš„æƒ…å†µï¼Œä¼°ç®—ä¸€ä¸‹Edenå¤§å°æ˜¯å¦è¶³å¤Ÿã€‚å¦‚æœä¸å¤Ÿçš„è¯ï¼Œå¯èƒ½è¦è°¨æ…åœ°åˆ›å»ºæ–°çº¿ç¨‹ï¼Œå¹¶ä¸”è®©ç©ºé—²çš„çº¿ç¨‹ç»ˆæ­¢ï¼›å¿…è¦çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦å¯¹JVMè¿›è¡Œè°ƒå‚ã€‚")])])])]),t._v(" "),s("li",[s("h4",{attrs:{id:"keepalivetime-0ä¼šæ€ä¹ˆæ ·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#keepalivetime-0ä¼šæ€ä¹ˆæ ·"}},[t._v("#")]),t._v(" keepAliveTime=0ä¼šæ€ä¹ˆæ ·")]),t._v(" "),s("p",[t._v("åœ¨JDK1.8ä¸­ï¼ŒkeepAliveTime=0è¡¨ç¤ºéæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œå®Œç«‹åˆ»ç»ˆæ­¢ã€‚")]),t._v(" "),s("p",[t._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒkeepAliveTimeå°äº0ï¼Œåˆå§‹åŒ–çš„æ—¶å€™æ‰ä¼šæŠ¥é”™ï¼›ä½†å¦‚æœ"),s("code",[t._v("allowsCoreThreadTimeOut")]),t._v("ï¼Œ"),s("code",[t._v("keepAliveTime")]),t._v("å¿…é¡»å¤§äº0ï¼Œä¸ç„¶åˆå§‹åŒ–æŠ¥é”™ã€‚")])]),t._v(" "),s("li",[s("h4",{attrs:{id:"æ€ä¹ˆè¿›è¡Œå¼‚å¸¸å¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ€ä¹ˆè¿›è¡Œå¼‚å¸¸å¤„ç†"}},[t._v("#")]),t._v(" æ€ä¹ˆè¿›è¡Œå¼‚å¸¸å¤„ç†")]),t._v(" "),s("ul",[s("li",[t._v("ä¸è®ºæ˜¯ç”¨executeè¿˜æ˜¯submitï¼Œéƒ½å¯ä»¥è‡ªå·±åœ¨ä¸šåŠ¡ä»£ç ä¸ŠåŠ try-catchè¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚æˆ‘ä¸€èˆ¬å–œæ¬¢ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºæˆ‘å–œæ¬¢å¯¹ä¸åŒä¸šåŠ¡åœºæ™¯çš„å¼‚å¸¸è¿›è¡Œå·®å¼‚åŒ–å¤„ç†ï¼Œè‡³å°‘æ‰“ä¸ä¸€æ ·çš„æ—¥å¿—å§ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœæ˜¯executeï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œç»§æ‰¿ThreadPoolExecutorå¹¶å¤å†™å…¶afterExecute(Runnable r, Throwable t)æ–¹æ³•ã€‚")]),t._v(" "),s("li",[t._v("æˆ–è€…å®ç°"),s("code",[t._v("Thread.UncaughtExceptionHandler")]),t._v("æ¥å£ï¼Œå®ç°"),s("code",[t._v("void uncaughtException(Thread t, Throwable e);")]),t._v("æ–¹æ³•ï¼Œå¹¶å°†è¯¥handlerä¼ é€’ç»™çº¿ç¨‹æ± çš„"),s("code",[t._v("ThreadFactory")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("ä½†æ˜¯æ³¨æ„ï¼ŒafterExecuteå’ŒUncaughtExceptionHandleréƒ½ä¸é€‚ç”¨submitã€‚å› ä¸ºé€šè¿‡ä¸Šé¢çš„FutureTask.run()ä¸éš¾å‘ç°ï¼Œå®ƒè‡ªå·±å¯¹Throwableè¿›è¡Œäº†try-catchï¼Œå°è£…åˆ°äº†outcomeå±æ€§ï¼Œæ‰€ä»¥åº•å±‚æ–¹æ³•executeçš„Workeræ˜¯æ‹¿ä¸åˆ°å¼‚å¸¸ä¿¡æ¯çš„ã€‚")])])]),t._v(" "),s("li",[s("h4",{attrs:{id:"å¦‚æœæ˜¯æ— ç•Œé˜Ÿåˆ—-çº¿ç¨‹æ•°é‡ä¼šå¢åŠ åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚æœæ˜¯æ— ç•Œé˜Ÿåˆ—-çº¿ç¨‹æ•°é‡ä¼šå¢åŠ åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å—"}},[t._v("#")]),t._v(" å¦‚æœæ˜¯æ— ç•Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ•°é‡ä¼šå¢åŠ åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å—")]),t._v(" "),s("p",[t._v("ç­”ï¼šä¸ä¼š")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("workerCountOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" corePoolSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨è¿™é‡ŒworkQueue.offer(command)ä¼šä¸€ç›´è¿”å›ç©ºï¼Œæ²¡æœ‰æ‰§è¡Œä¸‹é¢çš„elseifä¸­æ·»åŠ éæ ¸å¿ƒworkerçš„ä»£ç ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isRunning")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" workQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("offer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" recheck "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isRunning")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("workerCountOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"executoræ¡†æ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#executoræ¡†æ¶"}},[t._v("#")]),t._v(" "),s("code",[t._v("Executor")]),t._v("æ¡†æ¶")]),t._v(" "),s("p",[t._v("åœ¨"),s("code",[t._v("HotSpot VM")]),t._v("çš„çº¿ç¨‹æ¨¡å‹ä¸­ï¼Œ"),s("code",[t._v("Java")]),t._v("çº¿ç¨‹ï¼ˆ"),s("code",[t._v("java.lang.Thread")]),t._v("ï¼‰è¢«ä¸€å¯¹ä¸€æ˜ å°„ä¸ºæœ¬åœ°æ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚")]),t._v(" "),s("h3",{attrs:{id:"executoræ¡†æ¶çš„ç»“æ„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#executoræ¡†æ¶çš„ç»“æ„"}},[t._v("#")]),t._v(" "),s("code",[t._v("Executor")]),t._v("æ¡†æ¶çš„ç»“æ„")]),t._v(" "),s("p",[s("code",[t._v("Executor")]),t._v("æ¡†æ¶ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ")]),t._v(" "),s("ul",[s("li",[t._v("ä»»åŠ¡ã€‚åŒ…æ‹¬è¢«æ‰§è¡Œä»»åŠ¡éœ€è¦å®ç°çš„æ¥å£ï¼š"),s("code",[t._v("Runnable")]),t._v("æ¥å£æˆ–"),s("code",[t._v("Callable")]),t._v("æ¥å£")]),t._v(" "),s("li",[t._v("ä»»åŠ¡çš„æ‰§è¡Œã€‚åŒ…æ‹¬ä»»åŠ¡æ‰§è¡Œæœºåˆ¶çš„æ ¸å¿ƒæ¥å£"),s("code",[t._v("Executor")]),t._v("ï¼Œä»¥åŠç»§æ‰¿è‡ª"),s("code",[t._v("Executor")]),t._v("çš„"),s("code",[t._v("ExecutorService")]),t._v("æ¥å£ã€‚"),s("code",[t._v("Executor")]),t._v("æœ‰ä¸¤ä¸ªå…³é”®ç±»å®ç°äº†"),s("code",[t._v("ExecutorService")]),t._v("æ¥å£ï¼ˆ"),s("code",[t._v("ThreadPoolExecutor")]),t._v("å’Œ"),s("code",[t._v("ScheduledTreadPoolExecutor")]),t._v("ï¼‰ã€‚")]),t._v(" "),s("li",[t._v("å¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚åŒ…æ‹¬æ¥å£"),s("code",[t._v("Future")]),t._v("å’Œå®ç°ç±»"),s("code",[t._v("FutureTask")])])]),t._v(" "),s("p",[t._v("ç›¸å…³ç±»å’Œæ¥å£ç®€ä»‹")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("TheadPoolExecutor")]),t._v("æ˜¯çº¿ç¨‹æ± çš„æ ¸å¿ƒå®ç°ç±»ï¼Œç”¨æ¥æ‰§è¡Œè¢«æäº¤çš„ä»»åŠ¡ã€‚")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("ScheduledThreadPoolExecutor")]),t._v("ï¼Œå¯ä»¥åœ¨ç»™å®šçš„å»¶è¿Ÿåè¿è¡Œå‘½ä»¤ï¼Œæˆ–å®šæœŸæ‰§è¡Œå‘½ä»¤ã€‚æ¯”Timeræ›´çµæ´»ï¼Œä¸”åŠŸèƒ½å¼ºå¤§ã€‚")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Callable")]),t._v("å’Œ"),s("code",[t._v("Runnable")]),t._v("çš„ä¸åŒåœ¨äºï¼Œ"),s("code",[t._v("Callable")]),t._v("å¯ä»¥è¿”å›æ•°æ®ç»™ä¸»çº¿ç¨‹ã€‚è€Œ"),s("code",[t._v("Runnable")]),t._v("åªèƒ½è¿”å›ç»™å®šçš„ç»“æœã€‚æ‰€æœ‰æäº¤çš„"),s("code",[t._v("Runnable")]),t._v("æ¥å£çš„å®ç°ï¼Œæœ€ååœ¨åˆ›å»º"),s("code",[t._v("FutureTask")]),t._v("çš„æ—¶å€™ï¼Œéƒ½ä¼šè¢«è½¬ä¸º"),s("code",[t._v("Callable")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Future")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Callable")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ExecutorServiceä¸­å¯¹äºsubmit callableä»»åŠ¡çš„å®šä¹‰")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Future")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),t._v(" result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"scheduledthreadpoolexecutor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scheduledthreadpoolexecutor"}},[t._v("#")]),t._v(" "),s("code",[t._v("ScheduledThreadPoolExecutor")])]),t._v(" "),s("h4",{attrs:{id:"ç›¸å¯¹äºthreadpoolexecutorçš„åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç›¸å¯¹äºthreadpoolexecutorçš„åŒºåˆ«"}},[t._v("#")]),t._v(" ç›¸å¯¹äº"),s("code",[t._v("ThreadPoolExecutor")]),t._v("çš„åŒºåˆ«")]),t._v(" "),s("ol",[s("li",[t._v("ä½¿ç”¨"),s("code",[t._v("DelayQueue")]),t._v("ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—")]),t._v(" "),s("li",[t._v("è·å–ä»»åŠ¡çš„æ–¹å¼ä¸åŒ")]),t._v(" "),s("li",[t._v("æ‰§è¡Œå‘¨æœŸä»»åŠ¡åï¼Œå¢åŠ äº†é¢å¤–æ“ä½œ")])]),t._v(" "),s("h4",{attrs:{id:"å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°"}},[t._v("#")]),t._v(" å®ç°")]),t._v(" "),s("p",[s("code",[t._v("ScheduledThreadPoolExecutor")]),t._v("ä¼šæŠŠå¾…è°ƒåº¦çš„"),s("code",[t._v("ScheduledFurtureTask")]),t._v("æ”¾åˆ°ä¸€ä¸ª"),s("code",[t._v("DelayQueue")]),t._v("ä¸­ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ScheduledFutureTask")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("V")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FutureTask")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("V")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RunnableScheduledFuture")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("V")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­çš„åºå·")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" sequenceNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™ä¸ªä»»åŠ¡å°†è¦æ‰§è¡Œçš„å…·ä½“æ—¶é—´")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¡¨ç¤ºä»»åŠ¡æ‰§è¡Œçš„é—´éš”")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" period"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("DelayQueue")]),t._v("ç»§æ‰¿äº†"),s("code",[t._v("PriorityQueue")]),t._v("ï¼Œ")]),t._v(" "),s("blockquote",[s("p",[t._v("æ’åºè§„åˆ™ï¼Œorder by time ascï¼Œorder by sequenceNumber asc")])]),t._v(" "),s("p",[t._v("å¯¹"),s("code",[t._v("DelayQueue")]),t._v("çš„"),s("code",[t._v("take()")]),t._v("å’Œ"),s("code",[t._v("add()")]),t._v("éƒ½è¦åŠ é”ã€‚")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("task")])])]),t._v(" "),s("ol",[s("li",[t._v("è·å–"),s("code",[t._v("Lock")])]),t._v(" "),s("li",[t._v("è·å–å‘¨æœŸä»»åŠ¡\n"),s("ul",[s("li",[t._v("å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œå½“å‰çº¿ç¨‹åˆ°"),s("code",[t._v("Condition")]),t._v("ä¸­"),s("code",[t._v("await")]),t._v("ã€‚å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ¡åˆ¤æ–­")]),t._v(" "),s("li",[t._v("å¦‚æœå¤´å…ƒç´ çš„"),s("code",[t._v("time")]),t._v("æ¯”å½“å‰æ—¶é—´å¤§ï¼Œåˆ°"),s("code",[t._v("Condition")]),t._v("ä¸­"),s("code",[t._v("await")]),t._v("ã€‚å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ¡")]),t._v(" "),s("li",[t._v("è·å–æ‰€æœ‰"),s("code",[t._v("time")]),t._v("å°äºç­‰äºå½“å‰æ—¶é—´çš„"),s("code",[t._v("FurtureTask")]),t._v("ï¼Œå”¤é†’"),s("code",[t._v("Condition")]),t._v("ä¸­ç­‰å¾…çš„çº¿ç¨‹ï¼Œå¹¶äº¤ä»˜"),s("code",[t._v("FutureTask")]),t._v("æ‰§è¡Œã€‚")])])]),t._v(" "),s("li",[t._v("é‡Šæ”¾"),s("code",[t._v("Lock")])])]),t._v(" "),s("p",[s("strong",[s("code",[t._v("add")])])]),t._v(" "),s("ol",[s("li",[t._v("è·å–"),s("code",[t._v("Lock")])]),t._v(" "),s("li",[t._v("æ·»åŠ ä»»åŠ¡ï¼Œå¦‚æœä»»åŠ¡æ»¡è¶³æ‰§è¡Œæ¡ä»¶ï¼Œåˆ™å”¤é†’"),s("code",[t._v("Condition")]),t._v("ä¸­ç­‰å¾…çš„çº¿ç¨‹ï¼Œäº¤ä»˜æ‰§è¡Œã€‚")]),t._v(" "),s("li",[t._v("é‡Šæ”¾"),s("code",[t._v("Lock")])])]),t._v(" "),s("h3",{attrs:{id:"futuretask"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#futuretask"}},[t._v("#")]),t._v(" "),s("code",[t._v("FutureTask")])]),t._v(" "),s("p",[s("code",[t._v("FutureTask")]),t._v("é™¤äº†å®ç°"),s("code",[t._v("Future")]),t._v("æ¥å£å¤–ï¼Œè¿˜å®ç°äº†æ¥å£"),s("code",[t._v("Runnable")]),t._v("ã€‚å› æ­¤"),s("code",[t._v("FutureTask")]),t._v("å¯ä»¥äº¤ç»™"),s("code",[t._v("Executor")]),t._v("æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥ç”±è°ƒç”¨çº¿ç¨‹ç›´æ¥æ‰§è¡Œï¼ˆå¼ºè½¬åè°ƒç”¨"),s("code",[t._v("FutureTask.run()")]),t._v("ï¼‰ã€‚")]),t._v(" "),s("p",[s("code",[t._v("FutureTask")]),t._v("æœ‰ä¸‰ç§çŠ¶æ€")]),t._v(" "),s("ol",[s("li",[t._v("æœªå¯åŠ¨ï¼Œ"),s("code",[t._v("FutureTask.run()")]),t._v("æœªæ‰§è¡Œä¹‹å‰ã€‚")]),t._v(" "),s("li",[t._v("å·²å¯åŠ¨ï¼Œ"),s("code",[t._v("FutureTask.run()")]),t._v("çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ã€‚")]),t._v(" "),s("li",[t._v("å·²å®Œæˆï¼Œå¯ä»¥æ˜¯æ­£å¸¸ç»“æŸï¼Œä¹Ÿå¯ä»¥æ˜¯å–æ¶ˆ"),s("code",[t._v("Future.cancel(boolean mayInterruptIfRunning)")]),t._v("ï¼Œä¹Ÿå¯ä»¥æ˜¯å› ä¸ºæŠ›å‡ºå¼‚å¸¸è€Œç»“æŸã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("å½“"),s("code",[t._v("Future")]),t._v("å¤„äºæœªå¯åŠ¨æˆ–å·²å¯åŠ¨çŠ¶æ€æ—¶ï¼Œæ‰§è¡Œ"),s("code",[t._v("Future.get()")]),t._v("æ–¹æ³•å°†ä¼šå¯¼è‡´è°ƒç”¨çº¿ç¨‹é˜»å¡ï¼›å½“"),s("code",[t._v("Future")]),t._v("å¤„äºå·²å®ŒæˆçŠ¶æ€æ—¶ï¼Œæ‰§è¡Œ"),s("code",[t._v("Future.get()")]),t._v("æ–¹æ³•å°†ä¼šå¯¼è‡´è°ƒç”¨çº¿ç¨‹ç«‹å³è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"å®æˆ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®æˆ˜"}},[t._v("#")]),t._v(" å®æˆ˜")]),t._v(" "),s("h3",{attrs:{id:"çº¿ä¸Šé—®é¢˜å®šä½"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ä¸Šé—®é¢˜å®šä½"}},[t._v("#")]),t._v(" çº¿ä¸Šé—®é¢˜å®šä½")]),t._v(" "),s("h3",{attrs:{id:"æ€§èƒ½æµ‹è¯•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ€§èƒ½æµ‹è¯•"}},[t._v("#")]),t._v(" æ€§èƒ½æµ‹è¯•")])],1)}),[],!1,null,null,null);"function"==typeof e&&e(r);a.default=r.exports}}]);